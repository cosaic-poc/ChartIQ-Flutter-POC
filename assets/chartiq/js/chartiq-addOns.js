"use strict";(self.webpackChunksample_template_webpack=self.webpackChunksample_template_webpack||[]).push([[910],{807:(e,t,a)=>{a.d(t,{BG:()=>c,Md:()=>h,Xc:()=>n,_s:()=>d,bZ:()=>l,dK:()=>s,fc:()=>f,fv:()=>p,oQ:()=>u,wO:()=>m,xA:()=>i,yR:()=>o});var r=a(73);let i=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.CSVReader=t.CSVReader||class{constructor(e){const t=new FileReader;this.reader=t,this.file=e}async parse(e){const{reader:t}=this;return new Promise(((a,r)=>{t.readAsText(e),t.onload=e=>{const r=this.splitResults(t.result),i=r.shift(),n=!!i.match(/"/)?new RegExp(/,(?=")/):new RegExp(/,/);this.fields=i.split(n).map((e=>{let t;try{t=JSON.parse(e)}catch(a){t=e}return t})),""===r[r.length-1]&&r.pop(),this.results=r,a(r)},t.onerror=e=>{console.warn(e),r(e)}}))}determineLineBreak(e){const{length:t}=e;let a,r=Math.floor(.05*t),i=0;do{const t=e.substring(i,r);t.indexOf("\r\n")>-1?a="\r\n":t.indexOf("\n")>-1?a="\n":i+=r}while(!a);return a}splitResults(e){return e.split(this.determineLineBreak(e))}},t.DataLoader=t.DataLoader||class{constructor(e){const{stx:a}=e;if(a){if(this.stx=a,this.cssRequired=!0,a.dataLoader=this,t.UI){const e=({value:e})=>{e&&(setTimeout(this.subscribeToChanges,0,e),setTimeout(this.registerHotKeys,0,e))};t.UI.observeProperty("uiContext",a,e),a.addEventListener("destroy",(()=>t.UI.unobserveProperty("uiContext",a,e)))}}else console.warn("The DataLoader requires an stx parameter")}formatData(e,t){const{defaultPlotField:a}=this.stx.chart,{results:r,fields:i}=e,{name:n}=t,s=i.indexOf("DT"),o=i.indexOf("Date"),l=i.indexOf(n),c=l>-1;let d=[s>-1?s:o];c&&d.push(i.indexOf(n)),r.data=r.map((e=>{const t={};return e.split(",").forEach(((e,r)=>{if(c&&-1===d.indexOf(r))return;let n,s=i[r];try{n=JSON.parse(e)}catch(t){n=e}let o="DT"===s||"Date"===s?n:Number.parseFloat(n);t[i[r]]=o,r===l&&(delete t[i[r]],t[a]=o)})),t}))}importData(e){const t=this,{stx:a}=this,r=Object.fromEntries(e.formData.entries());let{color:i,display:n,name:s,panel:o,periodicity:l}=r;l=JSON.parse(l),this.formatData(e,r);const{results:c}=e,{data:d}=c,h={symbol:s,static:!0},u={data:d,symbolObject:h,panel:"true"===o||void 0,color:i};"secondary"===n?a.addSeries(s,u,(function(){let e=a.getSeries({symbol:s})[0];const r=a.tickFromDate(e.endPoints.end);a.chart.scroll=a.chart.dataSet.length-1-r+a.chart.maxTicks,t.registerDataWarnings(!0)})):(a.quoteDriver.pause(s),a.loadChart(h,{masterData:d,periodicity:l},(()=>{t.registerDataWarnings();const e=a.container.closest("cq-context-wrapper");e&&e.removeEmptyMsg&&e.removeEmptyMsg()})))}registerDataWarnings(e){const{stx:a}=this,r=a.addEventListener("menu",(({stx:e,menu:a})=>{a.matches(".ciq-period")&&t.UI.getMyContext(a)===e.uiContext&&e.dispatch("notification","changeperiodicity")}));let i,n;function s(){a.getSymbols({static:!0}).length||(a.removeEventListener(r),e&&(a.removeInjection(i),a.removeInjection(n)))}e&&(i=a.append("removeSeries",s),n=a.append("deleteHighlighed",s)),a.addEventListener("periodicity",(({stx:e,differentData:t})=>{const a=e.getSymbols({static:!0});a&&t&&a.forEach((t=>{e.removeSeries(t,e.chart),s()}))})),a.addEventListener("newChart",(()=>{s()}))}registerHotKeys(e){const a=t.getFromNS(e.config,"hotkeyConfig.hotkeys");if(!a)return;let r=a.find((({action:e})=>"dataLoader"===e));r&&(r.action=()=>{e.getAdvertised("Channel").write(null,"dataLoader",!0)})}subscribeToChanges(e){const{stx:a}=e,r=t.UI.BaseComponent.prototype;r.channelSubscribe("channel.dataLoader",(t=>{let i=t?{type:"dataLoader",params:{stx:a,context:e}}:{};r.channelWrite("channel.dialog",i,a)}),a)}}},n=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.ExtendedHours=t.ExtendedHours||function(e){var a=e.stx;this.filter=e.filter,a||(a=e,this.filter=!1);var r={};this.stx=a,this.stx.extendedHours=this,this.cssRequired=!0,a.addEventListener("theme",(function(e){for(var t in r={},a.layout.marketSessions)r.session||(r.session={}),r.session[t]=a.canvasStyle("stx_market_session "+t)})),a.addEventListener("symbolChange",(function(e){"master"!=e.action||!a.layout.extended||a.chart.market.market_def&&a.chart.market.sessions.length||t.alert("There are no Extended Hours for this instrument.")})),t.UI&&t.UI.KeystrokeHub.addHotKeyHandler("extendedHours",(({stx:e})=>{e.container.ownerDocument.body.keystrokeHub.context.advertised.Layout.setExtendedHours()}),a),this.prepare=function(e,t){for(var i in a.layout.extended=e,a.layout.marketSessions)r.session={},a.chart.market.disableSession(i);if(a.layout.marketSessions={},e)if(t||(t=["pre","post"]),t.length)for(var n=0;n<t.length;n++)a.layout.marketSessions[t[n]]=!0;else a.layout.marketSessions=t;for(i in a.layout.marketSessions)r.session||(r.session={}),r.session[i]=a.canvasStyle("stx_market_session "+i),a.chart.market.disableSession(i,!0)},this.complete=function(e){a.changeOccurred("layout"),a.chart.market.market_def?this.filter?(a.createDataSet(),a.draw(),e&&e()):a.loadChart(a.chart.symbol,e):e&&e()},this.set=function(e,t,a){this.prepare(e,t),this.complete(a)},this.stx.append("drawYAxis",(function(e,i){if(this.layout.extended&&e.yAxis==i.yAxis&&!1!==e.shareChartXAxis&&!e.hidden){var n=e.chart;if(!t.ChartEngine.isDailyInterval(this.layout.interval)&&(r.divider=this.canvasStyle("stx_market_session divider"),r.session)){for(var s,o,l=n.market,c=[],d={},h=0;h<n.dataSegment.length;h++){var u=n.dataSegment[h];if(u&&u.DT){var p=null;if(l.market_def)if(!s||s<=u.DT)o=l.getSession(u.DT),s=l[!(""===o||this.layout.marketSessions&&this.layout.marketSessions[o])?"getNextOpen":"getNextClose"](u.DT);var m=r.session[o];if(m&&(p=m.backgroundColor),d.color&&d.color!=p&&(c.push({start:d.start,end:d.end,color:d.color}),d={}),p){var f=this.layout.candleWidth;u.candleWidth&&(f=u.candleWidth),d.end=this.pixelFromBar(h,n)+f/2,d.start||0===d.start||(d.start=d.end-f+1),d.color=p}else d={}}}(d.start||0===d.start)&&c.push({start:d.start,end:d.end,color:d.color});var g=t.isTransparent(r.divider.backgroundColor),y=r.divider.width.replace(/px/g,""),v={y0:e.bottom,y1:e.top,color:r.divider.backgroundColor,type:"line",context:n.context,confineToPanel:e,pattern:"dashed",lineWidth:y,deferStroke:!0};for(this.startClip(e.name),n.context.beginPath(),a.highlightedDraggable&&(n.context.globalAlpha*=.3),h=0;h<c.length;h++)n.context.fillStyle=c[h].color,!g&&c[h].start>n.left&&this.plotLine(t.extend({x0:c[h].start,x1:c[h].start},v)),n.context.fillRect(c[h].start,e.top,c[h].end-c[h].start,e.bottom-e.top),!g&&c[h].end<n.right&&this.plotLine(t.extend({x0:c[h].end,x1:c[h].end},v));n.context.stroke(),this.endClip()}}}))}},s=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.FullScreen=t.FullScreen||function(e){if(e||(e={}),e.stx){try{if(window.location.host!==window.top.location.host)throw new Error(window.location.host+" does not match "+window.top.location.host)}catch(e){return void console.warn("Full screen mode disabled.")}this.stx=e.stx,this.stx.fullScreen=this,this.fullScreenButton=null,this.fullScreenState=!1,this.addFullScreenButton=function(){this.stx.registerChartControl&&(this.fullScreenButton=this.stx.registerChartControl("stx-full-screen","Full Screen",function(e){return function(t){e.fullScreenToggle(t),t.stopPropagation()}}(this)))},this.fullScreenToggle=function(e){var t=e.target.ownerDocument;t.documentElement.requestFullscreen||t.documentElement.webkitRequestFullscreen||t.documentElement.mozRequestFullscreen||t.documentElement.msRequestFullscreen?this.getFullScreenElement(t)?t.exitFullscreen?t.exitFullscreen():t.webkitExitFullscreen?t.webkitExitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.msExitFullscreen&&t.msExitFullscreen():t.documentElement.requestFullscreen?t.documentElement.requestFullscreen():t.documentElement.webkitRequestFullscreen?t.documentElement.webkitRequestFullscreen():t.documentElement.mozRequestFullscreen?t.documentElement.mozRequestFullscreen():t.documentElement.msRequestFullscreen&&t.documentElement.msRequestFullscreen():(this.fullScreenState=!this.fullScreenState,this.fullScreenRender())},this.fullScreenRender=function(){let e=null;if(e=this.stx.container.closest("*[cq-context], cq-context, body"),e){const t="full-screen",a=!0===this.fullScreenState?"add":"remove";this.fullScreenButton&&this.fullScreenButton.classList[a]("active"),e.classList[a](t),this.stx.channel.componentClass={...this.stx.channel.componentClass,[t]:a},window.dispatchEvent(new Event("resize"))}},this.onFullScreenChange=function(e){this.getFullScreenElement(e.target.ownerDocument)?this.fullScreenState=!0:this.fullScreenState=!1,this.fullScreenRender()},this.getFullScreenElement=function(e){return e.fullscreenElement||e.webkitCurrentFullScreenElement||e.mozFullScreenElement||e.msFullscreenElement};var t=this.onFullScreenChange.bind(this),a=this;["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach((function(e){a.stx.container.ownerDocument.addEventListener(e,t),a.stx.addEventListener("destroy",(function(){this.container.ownerDocument.removeEventListener(e,t)}))})),this.addFullScreenButton()}else console.warn("The Full Screen addon requires an stx parameter")}},o=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.InactivityTimer=t.InactivityTimer||function(e){if(e.minutes){(!e.interval||e.interval<0)&&(e.interval=60),this.stx=e.stx,this.timeout=e.minutes,this.interval=e.interval,this.wakeCB=e.wakeCB,this.sleepCB=e.sleepCB,this.sleepTimer=null,this.sleeping=!1,this.last=(new Date).getTime(),this.wakeChart=function(a){clearTimeout(this.sleepTimer),this.last=(new Date).getTime(),this.sleeping&&(this.stx.quoteDriver&&this.stx.quoteDriver.updateChartLoop(),this.sleeping=!1,this.stx.container.ownerDocument.body.classList.remove("ciq-sleeping"),a||t.ChartEngine.registeredContainers.forEach((function(t){e.stx!==t.stx&&t.stx.inactivityTimer&&t.stx.inactivityTimer.wakeChart(!0)}))),this.sleepTimer=setTimeout(this.sleepChart.bind(this),6e4*this.timeout),this.wakeCB&&this.wakeCB()},this.sleepChart=function(a){this.sleeping||(this.stx.quoteDriver&&this.stx.quoteDriver.updateChartLoop(this.interval),this.sleeping=!0,this.stx.container.ownerDocument.body.classList.add("ciq-sleeping"),a||t.ChartEngine.registeredContainers.forEach((function(t){e.stx!==t.stx&&t.stx.inactivityTimer&&t.stx.inactivityTimer.sleepChart(!0)}))),this.sleepCB&&this.sleepCB()};var a=this,r=this.stx.container.ownerDocument;["mousemove","mousedown","touchstart","touchmove","pointerdown","pointermove","keydown","wheel"].forEach((function(e){r.body.addEventListener(e,i,{passive:!1}),a.stx.addEventListener("destroy",(function(){r.body.removeEventListener(e,i),clearTimeout(a.sleepTimer)}))})),this.stx.inactivityTimer=this,this.wakeChart()}function i(){a.wakeChart()}}},l=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.RangeSlider=t.RangeSlider||function(e){this.cssRequired=!0;var a=e.stx;a.slider=this;var r=e.height?e.height:"95px",i=e.chartContainer?e.chartContainer:e.stx.container,n=document.createElement("div");n.className="ciq-chart";var s=document.createElement("div");s.className="chartContainer",n.appendChild(s),i.parentElement.parentElement.insertBefore(n,i.parentElement.nextSibling),Object.assign(n.style,{height:r,paddingTop:"5px",display:"none"}),s.style.height="100%",s.dimensionlessCanvas=!0;var o=this.slider=new t.ChartEngine({container:s,preferences:{labels:!1,whitespace:0}});o.linkedChartEngine=e.stx,o.xaxisHeight=30,o.manageTouchAndMouse=!1,o.minimumCandleWidth=0,o.chart.yaxisMarginMultiplier=1;var l=o.chart.panel,c=l.subholder,d=l.close;c.style.cursor="ew-resize",c.classList.add("stx_range_slider"),d&&(d.style.display="inline",t.safeClickTouch(d,(function(){a.layout.rangeSlider=!1,a.changeOccurred("layout")})));var h=l.yAxis;h.drawCurrentPriceLabel=!1,Object.defineProperty(h,"position",{get:function(){return a.slider.yAxisPosition||a.chart.panel.yAxis.position},set:function(e){a.slider.yAxisPosition=e}});const{get:u,set:p}=Object.getOwnPropertyDescriptor(t.ChartEngine.YAxis.prototype,"width");Object.defineProperty(h,"width",{get:function(){return Math.max(u.call(h),a.chart.yAxis.width)},set:function(e){p.call(h,e)}}),t.extend(h,e.yAxis),o.chart.baseline.userLevel=!1,o.controls.home&&(o.controls.home.style.width=0),o.initializeChart();const m=e=>o.notifyBreakpoint(e.value);t.UI&&(t.UI.KeystrokeHub.addHotKeyHandler("rangeSlider",(({stx:e})=>{e.container.ownerDocument.body.keystrokeHub.context.advertised.Layout.setRangeSlider()}),a),t.UI.observeProperty("breakpoint",a.chart,m)),this.updateStyles=function(e,t,r){a.setStyle(e,t,r),this.style=a.canvasStyle("stx_range_slider shading")},this.display=function(e){if(a.layout.rangeSlider!==e)return a.layout.rangeSlider=e,void a.changeOccurred("layout");n.style.display=e?"":"none",a.resizeChart(),n.ownerDocument.defaultView.dispatchEvent(new Event("resize")),e&&(o.resizeChart(),o.initializeChart(),this.requestDraw())},this.setSymbol=function(e){o.chart.panel.display=o.chart.symbol=e,o.chart.symbolObject={symbol:e},o.chart.market=a.chart.market,o.setMainSeriesRenderer(),o.resizeChart(),this.adjustRange(a.chart),this.requestDraw()},this.acceptLayoutChange=function(e){var r=!1;o.layout.rangeSlider!==e.rangeSlider&&a.slider.display(e.rangeSlider);["chartType","aggregationType","periodicity","interval","timeUnit","chartScale","rangeSlider","flipped","extended","marketSessions","kagi","rangebars","renko","priceLines","pandf"].forEach((function(a){t.equals(o.layout[a],e[a])||(o.layout[a]=e[a],r=!0)})),t.trulyVisible(n)&&r&&(o.setMainSeriesRenderer(),this.requestDraw())},this.adjustRange=function(e){if(e.dataSet&&e.endPoints&&e.endPoints.begin){var t=o.chart;if(t.width){var r=0,i=0;if(a.quoteDriver){var n={symbol:e.symbol,symbolObject:e.symbolObject,interval:a.layout.interval};"month"!=n.interval&&"week"!=n.interval||a.dontRoll||(n.interval="day");var s=a.quoteDriver.getQuoteFeed(n).behavior;s&&s.bufferSize&&(e.moreAvailable&&(r=s.bufferSize),a.isHistoricalMode()&&(i=s.bufferSize))}t.baseline.defaultLevel=e.baseline.actualLevel,t.scroll=Math.max(0,e.dataSet.length-a.tickFromDate(e.endPoints.begin)-r)+1,o.setMaxTicks(t.scroll-i+2)}}},this.copyData=function(e){if(e.dataSet&&e.masterData){var t=o.chart;t.masterData=o.masterData=e.masterData.slice(0),t.dataSet=e.dataSet.slice(0),t.state=e.state,this.requestDraw()}},this.calculateYAxisPosition=function(){var e=o.chart.panel;o.getYAxisCurrentPosition(e.yAxis,e)!=e.yAxis.position&&o.calculateYAxisPositions()},this.drawSlider=function(){if(t.trulyVisible(n)&&a.chart.dataSet&&a.chart.dataSet.length){var e=this.style;e||(e=this.style=a.canvasStyle("stx_range_slider shading"));var r=a.chart.panel,i=o.chart.context,s=o.chart.segmentImage||[],l=o.layout.candleWidth/2,d=o.tickLeft=Math.max(a.tickFromPixel(r.left+l),0),h=o.tickRight=Math.min(a.tickFromPixel(r.right-l),a.chart.dataSet.length-1),u=o.pixelLeft=o.pixelFromTick(d)-(s[d]?s[d].candleWidth/2:l),p=o.pixelRight=o.pixelFromTick(h)+(s[h]?s[h].candleWidth/2:l),m=c.offsetLeft,f=m+c.offsetWidth;i.save(),i.beginPath(),i.fillStyle=e.backgroundColor,i.fillRect(m,c.offsetTop,u-m,c.offsetHeight),i.fillRect(f,c.offsetTop,p-f,c.offsetHeight),i.strokeStyle=e.borderTopColor,i.lineWidth=parseInt(e.borderWidth,10),i.moveTo(u,c.offsetTop),i.lineTo(u,c.offsetTop+c.offsetHeight),i.moveTo(p,c.offsetTop),i.lineTo(p,c.offsetTop+c.offsetHeight),i.stroke(),i.beginPath(),i.lineWidth=parseInt(e.width,10),i.lineCap="round",i.moveTo(u,c.offsetTop+c.offsetHeight/4),i.lineTo(u,c.offsetTop+3*c.offsetHeight/4),i.moveTo(p,c.offsetTop+c.offsetHeight/4),i.lineTo(p,c.offsetTop+3*c.offsetHeight/4),i.stroke(),i.restore()}},this.requestDraw=function(){this.drawRequested||(this.drawRequested=setTimeout((()=>{o.draw(),this.drawSlider(),this.drawRequested=clearTimeout(this.drawRequested)}),100))},a.addEventListener("destroy",(function(e){t.UI.unobserveProperty("breakpoint",e.stx.chart,m),o.destroy()})),a.addEventListener("layout",(function(e){e.stx.slider.acceptLayoutChange(e.stx.layout)})),a.addEventListener("preferences",(function(e){const{language:a}=e.stx.preferences;t.I18N&&o.preferences.language!=a&&t.I18N.setLocale(o,a),o.preferences.language=a,this.slider.requestDraw()})),a.addEventListener("symbolChange",(function(e){"master"==e.action&&e.stx.slider.setSymbol(e.symbol)})),a.addEventListener("symbolImport",(function(e){"master"==e.action&&e.stx.slider.setSymbol(e.symbol),e.stx.slider.acceptLayoutChange(e.stx.layout)})),a.addEventListener("theme",(function(e){o.clearPixelCache();const{multiChartContainer:r}=a.uiContext.topNode,{breakpoint:i}=a.chart;if(r?(o.styles=r.styles[i]||{},r.styles[i]=o.styles):o.styles={},o.container.style.backgroundColor="",t.ThemeHelper){var n=new t.ThemeHelper({stx:e.stx});n.params.stx=o,n.update()}})),a.append("createDataSet",(function(...e){const[,,{animationEntry:t}={}]=e||[];t||(this.slider.adjustRange(this.chart),this.slider.copyData(this.chart))})),a.append("draw",(function({animationEntry:e}={}){!e&&t.trulyVisible(n)&&o.chart.dataSet&&(this.slider.calculateYAxisPosition(),this.slider.adjustRange(this.chart),this.slider.requestDraw())})),a.prepend("resizeChart",(function(){var e=i.parentElement;if(!e||!e.isConnected)return!0;var a=e.parentElement,r=t.elementDimensions(a).height,s=a.querySelectorAll(".chartContainer");Array.from(s).forEach((function(e){e!==i&&t.trulyVisible(e)&&(r-=t.elementDimensions(e.parentElement,{border:1,padding:1,margin:1}).height)})),e.style.height=r+"px",this.layout.rangeSlider?(n.style.display="",o.resizeChart(),o.initializeChart(),this.slider.requestDraw()):n.style.display="none"})),["mousedown","touchstart","pointerdown"].forEach((function(e){c.addEventListener(e,(function(e){var r=o.backOutX(e.pageX);if(r||0===r){r-=e.target.offsetLeft,o.startDrag=r,o.startPixelLeft=o.pixelLeft,o.startPixelRight=o.pixelRight;var i=a.slider.style;i||(i=a.slider.style=a.canvasStyle("stx_range_slider shading"));var n=parseInt(i.borderLeftWidth,10);(r+=this.offsetLeft)<o.pixelRight-n&&(o.needsLeft=!0),r>o.pixelLeft+n&&(o.needsRight=!0),t.touchDevice||o.needsLeft&&o.needsRight&&e.target.classList.add("stx-drag-chart")}}),{passive:!1})})),["mouseup","mouseover","touchend","pointerup"].forEach((function(e){c.addEventListener(e,(function(e){const{which:t,type:a}=e;1===t&&"pointerup"!==a&&"mouseup"!==a||(e.target.classList.remove("stx-drag-chart"),o.chart.panel.subholder.style.cursor="ew-resize",o.startDrag=null,o.needsLeft=!1,o.needsRight=!1)}))})),["mousemove","touchmove","pointermove"].forEach((function(e){c.addEventListener(e,(function(e){o.timeout||(o.timeout=setTimeout((()=>{const t=()=>o.timeout=clearTimeout(o.timeout),{startDrag:r,startPixelLeft:i,startPixelRight:n,needsLeft:s,needsRight:l}=o;let{tickLeft:c,tickRight:d}=o;if(!r&&0!==r)return t();const{touches:h}=e;let u=(h&&h.length?o.backOutX(h[0].pageX):o.backOutX(e.pageX))-e.target.offsetLeft;if(!u&&0!==u)return t();if(u-=r,s)i+u<o.chart.left&&(u=o.chart.left-i),l&&n+u>=o.chart.right&&(u=o.chart.right-n,o.isHome()||(u+=o.layout.candleWidth/2)),c=o.tickFromPixel(i+u),l&&(d=c+o.tickRight-o.tickLeft);else{if(!l)return t();d=Math.min(o.tickFromPixel(n+u),a.chart.dataSet.length-1)}let p=a.chart.width/(d-c+1);d>=c&&(s&&l||p>=a.minimumCandleWidth)&&(o.tickLeft=c,o.tickRight=d,a.chart.scroll=a.chart.dataSet.length-c,s&&l||a.setCandleWidth(p),a.micropixels=0,a.draw()),t()})))}),{passive:!1})})),this.adjustRange(a.chart),this.copyData(a.chart),a.draw()}},c=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.Shortcuts=t.Shortcuts||function({stx:e,width:a=580,windowForEachChart:r=!0,config:i}={}){if(!e)return void console.warn("The Shortcuts addon requires an stx parameter");this.stx=e,this.width=a,this.windowForEachChart=r,this.content=this.getShortcutContent(i),this.ensureMessagingAvailable(e),this.enableUI(e),this.cssRequired=!0,e.shortcuts=this,t.UI&&t.UI.KeystrokeHub.addHotKeyHandler("shortcuts",(({stx:e,options:t})=>{e.container.ownerDocument.body.keystrokeHub.context.advertised.Layout.showShortcuts()}),e);const n=this.stx.container.closest("cq-context"),s=new MutationObserver((()=>this.content=this.getShortcutContent(i)));s.observe(n,{attributes:!0}),this.mo=s},t.Shortcuts.prototype.enableUI=function(e){e&&t.UI&&setTimeout((()=>{e.uiContext.getAdvertised("Layout").showShortcuts=(e,t)=>this.toggle(t)}))},t.Shortcuts.prototype.ensureMessagingAvailable=function(e){setTimeout((()=>{const t=e.uiContext.topNode;Array.from(t.querySelectorAll("cq-floating-window")).find((e=>e.closest("cq-context")===t))||t.append(document.createElement("cq-floating-window"))}))},t.Shortcuts.prototype.getShortcutContent=function(e){const t=(e.drawingTools||[]).filter((e=>e.shortcut)).map((({label:e,shortcut:t})=>`<div class="ciq-shortcut">\n\t\t\t\t\t<div>${e}</div>\n\t\t\t\t\t<div><span>Alt</span> + <span>${t.toUpperCase()}</span></div>\n\t\t\t\t</div>`)).join(""),a=e=>" + "===e?"<span>+</span>":e.split("+").map((e=>e&&" "!==e?"<span>"+e+"</span>":"")).join(" + "),r=this.stx.container.closest("cq-context");if(!r)return void this.mo.disconnect();return`\n\t\t<div class="ciq-shortcut-container">\n\t\t\t<div>\n\t\t\t\t<div><b>Drawing tools shortcuts</b></div>\n\t\t\t\t<div>${t}</div>\n\t\t\t</div>\n\t\t\t<hr>\n\t\t\t<div>\n\t\t\t\t<div><b>Hotkeys</b></div>\n\t\t\t\t<div>${(e.hotkeyConfig&&e.hotkeyConfig.hotkeys||[]).map((({label:e,action:t,commands:i,extension:n})=>{return n&&(s=n,!r.hasAttribute(s.toLowerCase()+"-feature"))?"":`<div class="ciq-shortcut"><div>${e||t}</div><div>${(e=>e.map((e=>e.replace(/Arrow|Key|Digit|^ | $/g,""))).map((e=>e.replace(/\+/," + "))).reduce(((e,t)=>{return!e.includes(t)&&(a=t).charCodeAt(a.length-1)<127?e.concat(t):e;var a}),[]).map(a).join("<br>"))(i)}</div></div>`;var s})).join("")}</div>\n\t\t\t</div>\n\t\t</div>\n\t`},t.Shortcuts.prototype.toggle=function(e){this.stx.dispatch("floatingWindow",{type:"shortcut",title:"Shortcuts",content:this.content,container:this.stx.uiContext.topNode,onClose:()=>this.closed=!0,width:this.width,status:e,tag:this.windowForEachChart?void 0:"shortcut"})}},d=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;function a(){}t.TableView=t.TableView||function({stx:e,minColumnWidth:r="84px",coverUIMaxWidth:i=400,coverContainer:n,usePreviousCloseForChange:s=!0}={}){e?(this.stx=e,this.viewAdditionalColumns=!1,this.minColumnWidth=r,this.coverUIMaxWidth=i,this.coverContainer=n,this.usePreviousCloseForChange=s,this.builder=a,this.listeners=[],e.tableView=this,this.cssRequired=!0,t.UI&&(this.listener=({value:e})=>{e&&setTimeout((()=>{this.subscribeToChanges(e);const a=t.getFromNS(e.config,"hotkeyConfig.hotkeys",[]).find((({action:e})=>"tableView"===e));a&&(a.action=()=>{const{tableView:t}=e.topNode.ownerDocument.body.keystrokeHub.context.stx;if(t)return t.toggle(),!0})}))},t.UI.observeProperty("uiContext",e,this.listener)),setTimeout((()=>{this.setup({minColumnWidth:r,coverUIMaxWidth:i,coverContainer:n})}))):console.warn("The TableView addon requires an stx parameter")},t.TableView.prototype.setup=function(e){const{stx:t}=this;if(t.destroyed)return;const a=this.builder.getChartCover(t,e),r=this.builder.createToolbar(t,e);a.append(r),a.style.display="none",t.addEventListener("symbolChange",(()=>{this.view&&(this.close(),this.builder.createTable(t,e),this.dialog.focus())})),this.dialog=a,this.toolbar={symbol:r.querySelector(".ciq-data-table-title"),copyBtn:r.querySelector(".ciq-data-table-copy"),downloadBtn:r.querySelector(".ciq-data-table-download"),additional:r.querySelector(".ciq-data-table-additionalColumns")}},t.TableView.prototype.open=function(e){e&&(this.params=e);const{config:a={},onClose:r}=this.params||{};if(this.view&&this.close(!1),this.onClose=r,this.builder.createTable(this.stx,a),!this.dialog)return;const{stx:i}=this;if(!i.chart.masterData)return;const n=this.close.bind(this),s=this.dialog.ownerDocument.body.keystrokeHub;s&&s.addActiveModal(this.dialog),setTimeout((()=>this.removeCloseListener=function(e){const a=i.uiContext.topNode,r=a.ownerDocument.body,s=e=>{e.target.closest(".ciq-data-table-container")||(n(),e.stopPropagation())};a.addEventListener("click",s,!0);const o=e=>{const{tableView:a}=r.keystrokeHub.context.stx;if(a&&a.view)if("Escape"===e.code)a.close(),e.preventDefault();else{if(!t.UI||!t.UI.BaseComponent)return;const i=t.UI.BaseComponent.prototype,n=a.view.querySelectorAll("button");if("Tab"===e.code){let{shiftKey:t}=e||{};i.focusNextItem(n,t,!0);const a=i.findFocused(n);a[0]&&i.highlightItem.call({keyboardNavigation:r.keystrokeHub},a[0])}else if("Enter"===e.code){const t=i.findFocused(n);t[0]&&i.clickItem(t[0],e)}}};r.addEventListener("keydown",o);const l=t.getFn("UI.getUIManager")(a);l&&(e.view.show=e.view.hide=function(){},l.openMenu(e.view,{}));return()=>{a.removeEventListener("click",s,!0),r.removeEventListener("keydown",o),l&&l.closeMenu(e.view)}}(this)))},t.TableView.prototype.close=function(e=!0){let t;if(this.dialog&&(this.dialog.style.display="none"),this.view&&(t=this.view.ownerDocument.body,this.view.remove(),this.view=null),e&&this.onClose&&this.onClose(),this.removeCloseListener&&(this.removeCloseListener(),this.removeCloseListener=null),t&&t.keystrokeHub){let{tabActiveModals:e}=t.keystrokeHub,a=e.indexOf(this);a>-1&&e.splice(a,1),t.keystrokeHub.highlightAlign()}},t.TableView.prototype.toggle=function(){this[this.view?"close":"open"](),this.view||this.dialog.focus()},t.TableView.prototype.subscribeToChanges=function(e,a="channels.tableView"){const{channelSubscribe:r,channelWrite:i}=t.UI.BaseComponent.prototype,{channels:{tableView:n=a}={}}=e.config||{},{stx:s}=this;r(n,(e=>{s.tableView&&(e?(s.tableView.open({onClose:()=>{i(n,!1,s)}}),s.tableView.dialog.focus()):s.tableView.close())}),s),s.addEventListener("destroy",(()=>{this.dialog&&this.dialog.remove(),this.listener&&t.UI.unobserveProperty("uiContext",s,this.listener)}))},a.colHeaders={date:{label:"Date",alias:"DT"},open:{label:"Open"},high:{label:"High"},low:{label:"Low"},close:{label:"Close"},pctChange:{label:"% Change",cls:"ciq-extra"},pctChangeVsAvg:{label:"% Change vs Average",cls:"ciq-extra"},volume:{label:"Volume",cls:"ciq-extra"}},a.percentDecimalPlaces=2,a.createToolbar=function(e,t={}){const a=this,{symbolDisplay:r,symbol:i}=e.chart,{builder:n}=e.tableView,{dataToCsv:s,downloadCsv:o,getFilenameFormatter:l}=n,{fileNameFormatter:c=l(e)}=t,d=Object.assign({},this.colHeaders);return n.getCoverToolbar({symbol:r||i,viewAdditionalColumns:e.tableView.viewAdditionalColumns,copyFn:function(){const t=document.createElement("textArea");e.container.ownerDocument.body.appendChild(t),t.textContent=s(a.currentTable,{colHeaders:d,colSeparator:","}),t.select(),e.container.ownerDocument.execCommand("copy"),t.remove(),e.dispatch("notification","copytoclipboard")},downloadFn:function(){const t=s(a.currentTable,{colHeaders:d,colSeparator:","}),r=c(t);o(t,r,e)},toggleAdditionalColumnsFn:t=>{const{tableView:a}=e;a.viewAdditionalColumns=!a.viewAdditionalColumns,t.currentTarget.classList[a.viewAdditionalColumns?"add":"remove"]("ciq-active"),a.open()},closeFn:()=>e.tableView.close()})},a.createTable=function(e,a={}){if(!e.chart||!e.chart.dataSegment)return;const{tableView:r}=e,{builder:i}=r,{getChartData:n,dataToHtml:s,getDateFormatter:o,getValueFormatter:l,getVolumeFormatter:c,getSeriesDataNames:d,getStudyDataNames:h}=i,u=Object.assign({},this.colHeaders);if(e.chart.highLowBars||(delete u.open,delete u.high,delete u.low),!r.viewAdditionalColumns)for(let e in u)u[e].cls&&delete u[e];const p=Object.values(u).map((e=>e.label)),m=d(e);m.forEach((e=>u[e]={label:e}));const f=h(e);f.forEach((e=>{p.includes(e)||(u[e]={label:e})}));const g=m.concat(f),{dateFormatter:y=o(e),valueFormatter:v=l(e),percentFormatter:b=l(e,this.percentDecimalPlaces),volumeFormatter:k=c(e),minColumnWidth:x="84px"}=a,C=n(e,{dateFormatter:y,valueFormatter:v,percentFormatter:b,volumeFormatter:k,additionalDataFields:g});this.currentTable=C;const S=r.dialog;S.style.display="";const{symbolDisplay:w,symbol:P}=e.chart,M=`Symbol: ${w||P}`;return r.toolbar.symbol.innerText=M,r.toolbar.symbol.setAttribute("aria-label",M),setTimeout((()=>{const a=s(C,{colHeaders:u,minColumnWidth:x});S.appendChild(a),r.view=a;const i=t.getFromNS(e,"uiContext.config.scrollbarStyling");i&&(i.refresh(S.querySelector("tbody")),i.refresh(S.querySelector(".ciq-data-table-wrapper"),{suppressScrollY:!0})),e.translateUI&&e.translateUI(S),S.classList.remove("loading")})),S},a.dataToHtml=function(e,{colHeaders:t,minColumnWidth:a}){const r=Object.keys(t).length,i=`calc((100% - ${10+4*r}px ) / ${r})`,n=Object.entries(t).map((([,{label:e}],t)=>`<th\n\t\t\tscope="col"\n\t\t\tstyle="width: ${i};"\n\t\t\t>${e.replace("(","  (")}</th>`)),s=e.map((e=>`<tr>${Object.keys(t).map(((t,a)=>{const r=e[t];return 0===a?`<th scope="row"\n\t\t\t\t\t\t\tstyle="width: ${i}"\n\t\t\t\t\t\t>${r}</th>`:`<td style="width: ${i}">${r}</td>`})).join("")}</tr>`)),o=document.createElement("div");o.classList.add("ciq-data-table-wrapper");const l=a?`calc(${r} * ${a})`:"";return o.innerHTML=`\n\t\t<table class="header-fixed"\taria-description="Data visible in the chart"\n\t\t${l?`style="min-width: ${l}"`:""}>\n\t\t<thead role="rowgroup">${n.join("")}</thead>\n\t\t<tbody role="rowgroup">${s.join("")}</tbody>\n\t\t</table>`,o},a.dataToCsv=function(e,{colHeaders:t,colSeparator:a="\t"}){const r=Object.entries(t).map((([,{label:e}])=>`"${e}"`)).join(a),i=Object.entries(t).map((e=>e[1].alias||e[0]));return`${r}\n${e.map((e=>i.map((t=>`"${"DT"===t?e[t].toISOString():e[t]}"`)).join(a))).reverse().join("\n")}`},a.downloadCsv=function(e,t="filename",a=null){const r=new Blob([e],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");i.href=window.URL.createObjectURL(r,{type:"text/plain"}),i.download=`${t}.csv`,i.style.display="none";const n=((a||{}).container||{}).ownerDocument||document;n.body.appendChild(i),i.click(),n.body.removeChild(i)},a.getChartData=function(e,{dateFormatter:a,valueFormatter:r,percentFormatter:i,volumeFormatter:n,additionalDataFields:s}){const o=e.chart.dataSegment.filter((e=>null!==e)),{usePreviousCloseForChange:l}=e.tableView;let c=[],d=0;const h=o.reduce(((e,{Close:t,iqPrevClose:a,Open:r})=>{const i=l?a:r;return void 0===t||Number.isNaN(t)||void 0===i||Number.isNaN(i)?e:(d++,e+(t-i)/i)}),0)/d;return o.forEach(((o,d)=>{const{DT:u,displayDate:p,High:m,Low:f,Open:g,Close:y,iqPrevClose:v,Volume:b}=o,k=l?v:g,x=(y-k)/k,C=p||(e.displayZone?t.convertTimeZone(u,e.dataZone,e.displayZone):u),S={DT:u,date:a(C),open:r(g),close:r(y),change:r(y-k),pctChange:i(100*x),pctChangeVsAvg:i(100*(x-h)),high:r(m),low:r(f),volume:n(b)};s.forEach((e=>{let t=o[e];null!=t?("object"==typeof t&&(t=t.Close),S[e]=r(t)):S[e]=""})),c.push(S)})),c.sort(((e,t)=>t.DT-e.DT)),c},a.getDateFormatter=function(e){return(a,r)=>a?t.displayableDate(e,e.chart,a,!0):""},a.getValueFormatter=function(e,t){const{chart:{panel:a,yAxis:r},layout:{chartScale:i}}=e;let n;return n=r.originalPriceFormatter&&r.originalPriceFormatter.func?i=>r.originalPriceFormatter.func(e,a,i,t):r.priceFormatter&&"percent"!=i&&"relative"!=i?i=>r.priceFormatter(e,a,i,t):r=>e.formatYAxisPrice(r,a,t),e=>n(e).replace(/^-*0\.0*$/,"0")},a.getVolumeFormatter=function(e){return a=>{if(null==a)return"";if(e.internationalizer)return e.internationalizer.priceFormatters[0].format(a);const r=a.toString().split(".");return r[0]=t.commas(r[0]),r[0]}},a.getFilenameFormatter=function(e){return a=>{const r=e.chart.symbolDisplay||e.chart.symbol;let i,n;if(a){const e=a.split("\n");e.length>1&&([,i=""]=e[e.length-1].match(/^"([^"]*)"/)||[],[,n=""]=e[1].match(/^"([^"]*)"/)||[],i=t.yyyymmddhhmmssmmm(new Date(i)),n=t.yyyymmddhhmmssmmm(new Date(n)))}return`${r}${i?` (${i} _ ${n})`:""}`}},a.getChartCover=function(e,{coverUIMaxWidth:t,coverContainer:a}){const r=a&&e.container.ownerDocument.querySelector(a)||(e.uiContext&&e.container.offsetWidth<t?e.uiContext.topNode:e.container.parentElement.parentElement),i=document.createElement("div");Object.assign(i.style,{top:0,left:0,right:0,bottom:0}),i.classList.add("ciq-data-table-container","loading"),i.setAttribute("role","dialog"),i.setAttribute("aria-label","Data Table"),i.setAttribute("tabindex",0);const n=document.createElement("div");return n.classList.add("ciq-spinner-wrapper"),n.innerHTML='<span class="ciq-spinner"></span>',i.appendChild(n),r.appendChild(i),i},a.getCoverToolbar=function({symbol:e,viewAdditionalColumns:t,copyFn:a,downloadFn:r,toggleAdditionalColumnsFn:i,closeFn:n}){const s=document.createElement("div");s.classList.add("ciq-data-table-toolbar"),s.innerHTML=`\n\t\t<div class="ciq-data-table-title"></div>\n\t\t<button class="ciq-data-table-copy">${this.copyLabel}</button>\n\t\t<button class="ciq-data-table-download">${this.downloadLabel}</button>\n\t\t<div>\n\t\t\t<label class="additionalColumns" role="switch">\n\t\t\t\t<span class="ciq-switch"><span></span></span>\n\t\t\t\t<span>Show Additional Columns</span>\n\t\t\t</label>\n\t\t</div>\n\t\t<cq-close role="button" aria-label="close" />\n\t`;const o=s.querySelector(".ciq-data-table-title");o.textContent=e,o.setAttribute("aria-label",e),o.setAttribute("role","heading");const l=s.querySelector(".ciq-data-table-copy");a?l.addEventListener("click",a):l.style.display="none";const c=s.querySelector(".ciq-data-table-download");r?c.addEventListener("click",(function(){c.blur(),r()})):c.style.display="none";const d=s.querySelector(".additionalColumns");return i?d.addEventListener("click",i):d.style.display="none",s.close=n,s},a.copyLabel="Copy",a.downloadLabel="Download",a.getAdditionalColumnLabel=function(e){return`<span>${e?"- ":"+ "}</span>Additional columns`},a.getStudyDataNames=function(e){return Object.values(e.layout.studies||{}).filter((e=>!e.signalData||e.signalData.reveal)).map((function(e){return Object.keys(e.outputMap).filter(t)})).reduce(((e,t)=>e.concat(t)),[]);function t(t){return e.chart.dataSegment.some((e=>e&&e[t]))}},a.getSeriesDataNames=function(e){return Object.values(e.chart.seriesRenderers||{}).filter((e=>"_main_series"!==e.params.name)).map((e=>e.seriesParams.map((({symbol:e})=>e)))).reduce(((e,t)=>e.concat(t)),[])}},h=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.Marker?t.Tooltip=t.Tooltip||function(e){if(!t.Marker)return void console.warn("CIQ.Tooltip addon requires CIQ.Marker module to be enabled.");this.cssRequired=!0;const{stx:a,ohl:r,change:i,volume:n,series:s,studies:o,signalStudies:l,interpolation:c,showOverBarOnly:d,showBarHighlight:h=!0,useDataZone:u,caption:p}=e,{container:m}=a.chart;let f=m.querySelector(".hu-tooltip");if(f||(f=document.createElement("table"),f.classList.add("hu-tooltip"),m.appendChild(f)),p){let e=f.querySelector("caption");e||(e=document.createElement("caption"),f.insertBefore(e,f.firstChild)),e.innerHTML=a.translateIf(p)}let g=m.querySelector(".hu-tooltip-highlight");function y(){const{headsUp:e,crosshair:t}=a.layout,r=e&&e.floating||"floating"===e,i=t&&a.displayCrosshairs&&["static",null,void 0].includes(e);return!(!a.huTooltip||r||i)&&(v(),!0)}function v(){const{huTooltip:e}=a,{node:t}=e;t&&(t.style.left="-50000px",t.style.right="auto",t.ariaHidden="true",e.lastBar={},e.highlightEl&&(e.highlightEl.style.display="none"))}function b(){var e=this;if(!y()){var a=e.barFromPixel(e.cx),d=e.chart.dataSegment[a];if(d){if(!t.Marker.Tooltip.sameBar(d,e.huTooltip.lastBar)||a==e.chart.dataSegment.length-1){var h=e.huTooltip.node;h.parentElement.querySelectorAll("[auto]").forEach((e=>e.remove())),h.parentElement.querySelectorAll(".hu-tooltip-value").forEach((e=>e.innerHTML=""));var p=e.chart.panel,m=p.yAxis,f={},g=[];if(g.push({member:"DT",display:"DT",panel:p,yAxis:m}),g.push({member:"Close",display:"Close",panel:p,yAxis:m}),f.DT=f.Close=1,i&&t.ChartEngine.isDailyInterval(e.layout.interval)&&g.push({member:"Change",display:"Change",panel:p,yAxis:m}),r&&(g.push({member:"Open",display:"Open",panel:p,yAxis:m}),g.push({member:"High",display:"High",panel:p,yAxis:m}),g.push({member:"Low",display:"Low",panel:p,yAxis:m}),f.Open=f.High=f.Low=1),n&&(g.push({member:"Volume",display:"Volume",panel:null,yAxis:null}),f.Volume=1),s){var b=e.chart.seriesRenderers;for(var k in b){var x=b[k];if(x!==e.mainSeriesRenderer){p=e.panels[x.params.panel],!(m=x.params.yAxis)&&x.params.shareYAxis&&(m=p.yAxis);for(var C=0;C<x.seriesParams.length;C++){var S=x.seriesParams[C],w=S.symbol,P=S.field;w?P&&w!=P&&(w=t.createObjectChainNames(w,P)[0]):w=P;var M=S.display||S.symbol||S.field;w&&!f[M]&&(g.push({member:w,display:M,panel:p,yAxis:m,isSeries:!0}),f[M]=1)}}}}if(o||l)for(var D in e.layout.studies){var T=e.layout.studies[D];if(l||!T.signalData||T.signalData.reveal){for(var L in m=(p=e.panels[T.panel])&&T.getYAxis(e),e.layout.studies[D].outputMap)L&&!f[L]&&(g.push({member:L,display:L,panel:p,yAxis:m}),f[L]=1);f[D+"_hist"]||(g.push({member:D+"_hist",display:D+"_hist",panel:p,yAxis:m}),f[D+"_hist"]=1),f[D+"_hist1"]||(g.push({member:D+"_hist1",display:D+"_hist1",panel:p,yAxis:m}),f[D+"_hist1"]=1),f[D+"_hist2"]||(g.push({member:D+"_hist2",display:D+"_hist2",panel:p,yAxis:m}),f[D+"_hist2"]=1)}}for(var E=0;E<g.length;E++){var A=g[E],F=A.member,q=A.display,I="DT"==F;!I||u||t.ChartEngine.isDailyInterval(e.layout.interval)||(F="displayDate"),p=A.panel;var O=null;(m=A.yAxis)&&(p&&p===p.chart.panel?(O=Math.max(m.printDecimalPlaces,p.chart.decimalPlaces),(m.maxDecimalPlaces||0===m.maxDecimalPlaces)&&(O=Math.min(O,m.maxDecimalPlaces))):m.decimalPlaces||0===m.decimalPlaces?O=m.decimalPlaces:(m.maxDecimalPlaces||0===m.maxDecimalPlaces)&&(O=m.maxDecimalPlaces));var H=null,_=t.existsInObjectChain(d,F);_?H=_.obj[_.member]:"Change"==F&&(H=d.Close-d.iqPrevClose);var z=q.replace(/^(Result )(.*)/,"$2");if(c&&g[E].isSeries&&null==H){var Q=e.valueFromInterpolation(a,z,"Close",p,m);if(null===Q)break;H=Q}if(!H&&0!==H||!I&&"object"==typeof H&&!H.Close&&0!==H.Close){var R=h.querySelector('.hu-tooltip [hu-tooltip-field="'+z+'"]');if(R)""!==R.querySelector(".hu-tooltip-name").innerHTML&&(R.querySelector(".hu-tooltip-value").innerHTML="n/a")}else{var j="";if((H.Close||0===H.Close)&&(H=H.Close),H.constructor==Number)if(m)j=m.originalPriceFormatter&&m.originalPriceFormatter.func?m.originalPriceFormatter.func(e,p,H,O):m.priceFormatter&&m.priceFormatter!=t.Comparison.priceFormat?m.priceFormatter(e,p,H,O):e.formatYAxisPrice(H,p,O,m);else{j=H;var $=e.internationalizer;if($){var N=$.priceFormatters.length,V=t.countDecimals(j);V>=N&&(V=N-1),j=$.priceFormatters[V].format(j)}}else H.constructor==Date?I&&e.controls.floatDate&&e.controls.floatDate.innerHTML?j=e.chart.xAxis.noDraw?"N/A":t.displayableDate(e,p.chart,H):(j=t.yyyymmdd(H),t.ChartEngine.isDailyInterval(e.layout.interval)||(j+=" "+H.toTimeString().substring(0,8))):j=H;var B=h.querySelector('.hu-tooltip [hu-tooltip-field="'+z+'"]');if(B){B.querySelector(".hu-tooltip-value").innerHTML=j;var U=B.querySelector(".hu-tooltip-name");""===U.innerHTML&&(U.innerHTML=z,e.translateUI&&e.translateUI(U))}else{var W=document.createElement("tr");W.setAttribute("hu-tooltip-field",""),W.setAttribute("auto",!0);var Y=document.createElement("td");Y.classList.add("hu-tooltip-name"),Y.innerHTML=e.translateIf(z),W.appendChild(Y);var X=document.createElement("td");X.classList.add("hu-tooltip-value"),X.innerHTML=j,W.appendChild(X),(h.querySelector("tbody")||h).appendChild(W)}}}e.huTooltip.render()}}else v()}}function k(e){if("-50000px"!==e.node.style.left){var r=a.controls.mSticky;if(r&&"none"!==r.style.display){var i=t.stripPX(e.node.style.top)-t.elementDimensions(r,{padding:!0,border:!0,margin:!0}).height;i<0&&(e.node.style.top=t.stripPX(e.node.style.top)-i+"px",i=0);var n=r.style;t.efficientDOMUpdate(n,"top",i+"px"),t.efficientDOMUpdate(n,"left",e.node.style.left),t.efficientDOMUpdate(n,"right",e.node.style.right)}}}g||(g=document.createElement("div"),g.classList.add("hu-tooltip-highlight"),m.appendChild(g)),t.Marker.Tooltip=function(e){this.className||(this.className="CIQ.Marker.Tooltip"),this.highlightEl=g,e.label="tooltip",t.Marker.call(this,e)},t.inheritsFrom(t.Marker.Tooltip,t.Marker,!1),t.Marker.Tooltip.sameBar=function(e,t){return!(!e||!t)&&(+e.DT==+t.DT&&(e.Close==t.Close&&(e.Open==t.Open&&e.Volume==t.Volume)))},t.Marker.Tooltip.placementFunction=function(e){if(!y()){for(var a=e.stx,r=0;r<e.arr.length;r++){var i,n,s,o=e.arr[r],l=a.barFromPixel(a.cx),c=a.chart.dataSegment[l],u=!0;if("undefined"!=c&&c&&c.DT&&(i=!0,c.High&&(n=a.pixelFromPrice(c.High)),c.Low&&(s=a.pixelFromPrice(c.Low)),a.chart.highLowBars||c.Close&&(n=a.pixelFromPrice(c.Close)-15,s=a.pixelFromPrice(c.Close)+15),!d||a.cy>=n&&a.cy<=s||(u=!1)),!a.insideChart||a.openDialog||a.activeDrawing||a.grabbingScreen||!i||!u)return g.style.display="none",o.node.style.left="-50000px",o.node.style.right="auto",o.node.ariaHidden="true",void(o.lastBar={});if(t.Marker.Tooltip.sameBar(a.chart.dataSegment[l],o.lastBar)&&l!=a.chart.dataSegment.length-1)return void k(o);o.lastBar=a.chart.dataSegment[l];var p=o.lastBar.candleWidth||a.layout.candleWidth;parseInt(getComputedStyle(o.node).width,10)+a.chart.panel.left+30+p<a.backOutX(t.ChartEngine.crosshairX)?(o.node.style.left="auto",o.node.style.right=Math.round(m.clientWidth-a.pixelFromBar(l)+30)+"px"):(o.node.style.left=Math.round(a.pixelFromBar(l)+30)+"px",o.node.style.right="auto"),o.node.ariaHidden="false";var f=parseInt(getComputedStyle(o.node).height,10),v=Math.round(a.backOutY(t.ChartEngine.crosshairY)-f/2);if(v+f>a.height&&(v=a.height-f),v<0&&(v=0),o.node.style.top=v+"px",k(o),h&&!a.layout.crosshair){const e=o.lastBar.candleWidth||a.layout.candleWidth,t=a.pixelFromBar(l)-e/2;let r=e;t+r>a.chart.width&&(r=a.chart.width-t),g.style.display="block",g.style.left=t+"px",g.style.width=r+"px"}else g.style.display="none"}if(t.touchDevice&&a.layout.crosshair){var b=a.overXAxis,x=a.overYAxis;a.overXAxis=a.overYAxis=!1,a.doDisplayCrosshairs(),a.overXAxis=b,a.overYAxis=x}}},m.addEventListener("mouseout",v),a.append("mousemoveinner",(function(){k(this.huTooltip)})),a.append("deleteHighlighted",(function(){this.huTooltip.lastBar={},this.headsUpHR()})),a.append("headsUpHR",b),a.append("createDataSegment",b),a.huTooltip=new t.Marker.Tooltip({stx:a,xPositioner:"bar",chartContainer:!0,node:f})}:console.error("tooltip addon requires first activating markers feature.")},u=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.Animation=t.Animation||function(e){if(!e)throw new Error("Invalid constructor arguments.");var a,r,i;if(e instanceof t.ChartEngine?(a=arguments[0],r=arguments[1],i=arguments[2]):(a=e.stx,r=e.animationParameters,i=e.easeMachine),!a)return console.warn("No CIQ.ChartEngine provided. Cannot properly create CIQ.Animation instance");this.cssRequired=!0;var n={stayPut:!1,ticksFromEdgeOfScreen:5,granularity:1e6};r=t.extend(n,r),n.tension&&(a.chart.tension=r.tension),a.tickAnimator=i||new t.EaseMachine("easeOutCubic",1e3);var s=new t.EaseMachine("easeInOutCubic",1e3),o=["#0298d3","#19bcfc","#5dcffc","#9ee3ff"],l=0,c=20,d=0,h=!1,u=null;function p(){h=!1,u=null}if(t.UI){var m=({value:e})=>{n.tension&&(a.chart.tension=e?r.tension:0)};t.UI.observeProperty("animation",a.layout,m),a.addEventListener("destroy",(function(){t.UI.unobserveProperty("animation",a.layout,m)}))}a.addEventListener(["symbolChange","layout"],(function(e){p()})),a.prepend("updateCurrentMarketData",(function(e,t,a,r){t||(t=this.chart),r&&r.fromTrade&&t.closePendingAnimation&&(r.finalClose=t.closePendingAnimation.Close)})),a.prepend("updateChartData",(function(e,a,i){var n=this;if(a||(a=n.chart),a&&a.defaultChartStyleConfig&&"none"!=a.defaultChartStyleConfig&&this.layout.animation&&(void 0===i||!i.animationEntry&&!i.secondarySeries)&&a.dataSegment){var s=n.tickAnimator,o=this.mainSeriesRenderer.supportsAnimation;if(o){if(!s)return void console.warn("Animation plug-in can not run because the tickAnimator has not been declared. See instructions in animation.js");if(this.prevSymbol!=a.symbol&&(this.prevQuote=0,a.closePendingAnimation=null,this.prevSymbol=a.symbol),D(),s.stop(),e.length>1){var l=e.splice(0,e.length-1),c=t.clone(i);c.animationEntry=!0,c.bypassGovernor=!0,c.noCreateDataSet=!1,c.appending=!0,n.updateChartData(l,a,c)}}var d=t.clone(i);d||(d={}),d.animationEntry=!0,d.bypassGovernor=!0,d.noCreateDataSet=!1,d.appending=!0,d.firstLoop=!0;var p=this.chart.symbol,m=this.layout.periodicity,f=this.layout.interval,g=this.layout.timeUnit;if(o){var y=e[e.length-1];this.prevQuote=this.currentQuote("Close");var v=!1,b=!1;if(n.isHome()||(b=!0),!(y&&y.Close&&this.prevQuote&&this.prevQuote.Close))return!1;if(this.extendedHours&&a.market.market_def){var k=y.DT;if(t.ChartEngine.isDailyInterval(f))h=!a.market.isMarketDate(k);else if(!u||u<=k){var x=a.market.getSession(k);h=!(""===x||this.layout.marketSessions&&this.layout.marketSessions[x]),u=a.market[h?"getNextOpen":"getNextClose"](k)}if(h)return this.draw(),!1}var C=m;"second"==f||"second"==g?C*=1e3:"minute"!=f&&"minute"!=g||(C*=6e4),isNaN(f)||(C*=f),v="day"==f||"day"==g?y.DT.getDate()!=this.prevQuote.DT.getDate():"week"==f||"week"==g?y.DT.getDate()>=this.prevQuote.DT.getDate()+7:"month"==f||"month"==g?y.DT.getMonth()!=this.prevQuote.DT.getMonth():y.DT.getTime()>=this.prevQuote.DT.getTime()+C;var S=!this.mainSeriesRenderer.standaloneBars,w=0;if(v){if(!this.animations.zoom.hasCompleted)return!1;var P=this.layout.candleWidth;if(a.scroll<=a.maxTicks)for(;this.micropixels>0;)a.scroll++,this.micropixels-=P;w=-1*P,a.scroll<=a.maxTicks?(this.previousMicroPixels=this.micropixels,this.nextMicroPixels=this.micropixels+P,a.dataSegment.length<a.maxTicks-r.ticksFromEdgeOfScreen&&!r.stayPut&&(this.nextMicroPixels=this.micropixels,a.scroll>=a.maxTicks-this.preferences.whitespace/this.layout.candleWidth&&a.scroll++),a.animatingHorizontalScroll=S,a.previousDataSetLength=a.dataSet.length):b||a.scroll++}a.closePendingAnimation={Close:y.Close,Open:y.Open,High:y.High,Low:y.Low};var M=v&&!S?y.Open:this.prevQuote.Close;return s.run(function(e,i,o){return function(l){var c=l.Close;if(!a.dataSet.length||p!=a.symbol||m!=n.layout.periodicity||f!=n.layout.interval||g!=n.layout.timeUnit)return s.stop(),void D();var h=t.clone(e);h.Adj_Close=null,h.Close=Math.round(c*r.granularity)/r.granularity,a.animatingHorizontalScroll&&(n.micropixels=l.micropixels,a.lastTickOffset=l.lineOffset),d.updateDataSegmentInPlace=!s.hasCompleted;var u=[h];o&&"tick"!==n.layout.interval&&u.unshift(i),n.updateChartData(u,a,d),d.firstLoop=!1,s.hasCompleted&&D()}}(y,t.clone(this.prevQuote),v),{Close:M,micropixels:this.nextMicroPixels,lineOffset:w},{Close:y.Close,micropixels:this.micropixels,lineOffset:0}),!0}}function D(){a.animatingHorizontalScroll&&(a.animatingHorizontalScroll=!1,n.micropixels=n.nextMicroPixels=n.previousMicroPixels,a.lastTickOffset=0),a.closePendingAnimation&&(!function(e){if(a.masterData)for(var t=a.masterData.length-1;t>=0;t--){var r=a.masterData[t];if(r.Close||0===r.Close)return r.Close=e.Close,e.LastSize&&(r.LastSize=e.LastSize),e.LastTime&&(r.LastTime=e.LastTime),void 0===e.Open&&void 0!==r.Open&&(r.Open=e.Close),void 0===e.High&&void 0!==r.High&&(r.High=e.Close),void 0===e.Low&&void 0!==r.Low&&(r.Low=e.Close),n.updateCurrentMarketData({Close:r.Close,DT:r.DT,LastSize:r.LastSize,LastTime:r.LastTime},null,null,{animationLastBar:!0,fromTrade:!0}),void n.createDataSet(null,null,{appending:!0})}}(a.closePendingAnimation),a.closePendingAnimation=null)}})),a.prepend("renderYAxis",(function(e){if(!this.grabbingScreen&&this.isHome()&&this.layout.animation&&this.mainSeriesRenderer.supportsAnimation){var a=e.panel.yAxis;if(!t.Comparison||a.priceFormatter!=t.Comparison.priceFormat)if(e.prevLowValue||0===e.prevLowValue||(e.prevLowValue=e.animatedLow=e.lowValue),e.prevHighValue||0===e.prevHighValue||(e.prevHighValue=e.animatedHigh=e.highValue),s.running||(e.animatingVerticalScroll=!1),e.prevLowValue>=e.lowValue&&e.prevHighValue<=e.highValue)e.animatingVerticalScroll&&(a.highValue=e.animatedHigh,a.lowValue=e.animatedLow);else if(s.running&&s.stop(),e.lowValue||e.highValue){var r=e.prevLowValue,i=e.prevHighValue;e.prevLowValue=e.lowValue,e.prevHighValue=e.highValue,e.animatingVerticalScroll=!0,s.run(function(t){return function(a){e.animatedLow=a.low,e.animatedHigh=a.high,t.draw()}}(this),{low:r,high:i},{low:e.lowValue,high:e.highValue}),a.lowValue=e.animatedLow,a.highValue=e.animatedHigh}}})),a.append("draw",(function(){if(!h&&this.chart.dataSet&&this.chart.dataSet.length&&this.mainSeriesRenderer.supportsAnimation&&this.layout.animation){d%c==0&&(l++,d=0),d++;var e=this.chart.context,t=this.chart.panel,a=this.currentQuote("Close");if(!a)return;var r=a.Close,i=this.pixelFromTick(a.tick,this.chart);this.chart.lastTickOffset&&(i+=this.chart.lastTickOffset);var n=this.pixelFromPrice(r,t);this.chart.yAxis.left>i&&this.chart.yAxis.top<=n&&this.chart.yAxis.bottom>=n&&(l>=o.length&&(l=0),e.beginPath(),e.moveTo(i,n),e.arc(i,n,2+1.07*l,0,2*Math.PI,!1),e.fillStyle=o[l],e.fill())}}))}},p=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.ContinuousZoom=t.ContinuousZoom||function(e){this.cssRequired=!0,this.update(e),this.stx.continuousZoom=this,this.addSmartZoomButton=function(){var e=this.stx.registerChartControl&&this.stx.registerChartControl("stx-smart-zoom","SmartZoom (Alt + 0)",function(e){return function(t){e.smartZoomToggle(t),t.stopPropagation()}}(this));e&&(this.stx.addEventListener("layout",(function(t){!0===t.stx.layout.smartzoom?e.classList.add("active"):e.classList.remove("active")})),this.stx.addEventListener("symbolImport",(function(t){!1===t.stx.layout.smartzoom&&e.classList.remove("active")})))},this.smartZoomToggle=function(e){this.smartZoomEnable(!this.stx.layout.smartzoom)},this.smartZoomEnable=function(e){this.stx.layout.smartzoom=e,this.stx.changeOccurred("layout")},this.addSmartZoomButton(),this.smartZoomEnable(!0)},t.ContinuousZoom.prototype.update=function(e){e||(e={}),this.stx=e.stx,this.periodicities=e.periodicities,this.boundaries=e.boundaries},t.ContinuousZoom.prototype.execute=function(e){function t(e){var t=e.period||e.periodicity,a=e.interval,r=e.timeUnit||"minute";switch(isNaN(a)&&(r=a,a=1),r){case"month":a*=4.35;case"week":a*=7;case"day":a*=1440;case"minute":a*=60;case"second":break;case"millisecond":a/=1e3;break;default:return null}return t*a}if(this.stx&&this.stx.layout.smartzoom){var a=this.periodicities,r=this.boundaries,i=this.stx,n=i.layout,s=i.chart;if(a&&r&&(!e&&r.maxCandleWidth&&n.candleWidth>r.maxCandleWidth||e&&r.minCandleWidth&&n.candleWidth<r.minCandleWidth||!e&&r.minTicks&&s.maxTicks<r.minTicks||e&&r.maxTicks&&s.maxTicks>r.maxTicks)){for(var o={value:e?Number.MAX_VALUE:0},l=t(n),c=0;c<a.length;c++){var d=t(a[c]);(d>l&&d<o.value&&e||d<l&&d>o.value&&!e)&&(o={value:d,periodicity:a[c]})}var h=o.periodicity;h&&i.setRange({dtLeft:s.xaxis[0].DT,dtRight:s.xaxis[s.xaxis.length-1].DT,dontSaveRangeToLayout:!0,periodicity:h,padding:i.preferences.whitespace})}}}},m=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.Outliers=t.Outliers||function(e){if(e||(e={}),e.stx){Array.isArray(e.altColors)||(e.altColors=["#323390","#66308f","#0073ba","#f4932f","#0056a4","#00a99c","#00a553","#ea1d2c","#e9088c","#fff126","#912a8e","#ee652e","#00afed","#8ec648"]),this.stx=e.stx,this.stx.outliers=this,this.cssRequired=!0,this.multiplier=e.multiplier||3,this.altColors=e.altColors,this.axisData={},this.stx.addEventListener("layout",(function(e){Object.keys(e.stx.outliers.axisData).forEach(function(e){this.removeAllMarkers(this.axisData[e]),delete this.axisData[e]}.bind(e.stx.outliers))})),t.UI&&t.UI.KeystrokeHub.addHotKeyHandler("outliers",(({stx:e})=>{e.container.ownerDocument.body.keystrokeHub.context.advertised.Layout.setOutliers()}),this.stx),this.processDataSet=function(e,t,a){if(!e.length||e.length<=1)return!1;var r=[0,0];if(!this.axisData[a.name]){var i="",n=-1;Object.keys(this.axisData).forEach(function(e){this.axisData[e].panel.name==t.name&&n++}.bind(this)),n>-1&&n<this.altColors.length&&(i=this.altColors[n]),this.axisData[a.name]={axis:a,panel:t,displayState:"none",isFlipped:!1,originalZoom:a.zoom,markerColor:i,markers:{},axisMarkers:{}}}var s=this.axisData[a.name];return Object.assign(s,this.find(e)),this.refreshMarkerArray(s),this.refreshMarkers(s),"low"!==s.displayState&&"all"!==s.displayState||null===s.outlierMin?r[0]=s.trendMin:r[0]=s.outlierMin,"high"!==s.displayState&&"all"!==s.displayState||null===s.outlierMax?r[1]=s.trendMax:r[1]=s.outlierMax,r},this.find=function(e){if(e.length&&!(e.length<=0)){var t,a,r=function(e,t){return{quote:e.quote,DT:e.quote.DT,value:e.value,position:t}},i=null,n=null,s=null,o=null,l=[],c=e.slice();c.sort((function(e,t){return e.value-t.value}));var d=c.length,h=c[Math.floor(d/4)].value,u=c[Math.floor(d*(3/4))].value,p=u-h;t=h-p*this.multiplier,a=u+p*this.multiplier;for(var m=0;m<d;m++){var f=c[m],g=c[d-(m+1)];if(f.value<=t&&l.push(r(f,"low")),g.value>=a&&l.push(r(g,"high")),null===s&&f.value<=t&&(s=f.value),null===o&&g.value>=a&&(o=g.value),null===i&&f.value>t&&(i=f.value),null===n&&g.value<a&&(n=g.value),null!==i&&null!==n)break}return{minValue:t,maxValue:a,trendMin:i,trendMax:n,outlierMin:s,outlierMax:o,activeOutliers:l}}},this.refreshMarkerArray=function(e){this.deprecateMarkers(e);var t=e.markers;e.activeOutliers.forEach(function(a){var r=a.DT.getTime().toString();t[r]||(t[r]={isFresh:!0,type:"quote",value:a.value,marker:this.markOutlier(a,a.position,e)}),t[r].isFresh=!0}.bind(this)),null!==e.outlierMax&&(t.axisHigh||(t.axisHigh={isFresh:!0,type:"axis",value:e.outlierMax,marker:this.markAxis("high",e)}),t.axisHigh.isFresh=!0),null!==e.outlierMin&&(t.axisLow||(t.axisLow={isFresh:!0,type:"axis",value:e.outlierMin,marker:this.markAxis("low",e)}),t.axisLow.isFresh=!0)},this.setDisplayState=function(e,t){"high"!=e&&"low"!=e&&"all"!=e&&(e="none");var a=e;"all"==t.displayState&&"high"==e?a="low":"all"==t.displayState&&"low"==e?a="high":"high"==t.displayState&&"low"==e||"low"==t.displayState&&"high"==e?a="all":t.displayState==e&&(a="none"),t.displayState=a,t.axis.zoom=t.originalZoom,this.refreshMarkers(t),this.stx.draw()},this.deprecateMarkers=function(e){Object.keys(e.markers).forEach(function(e){var t;(t=this.markers[e]).marker&&!t.isFresh?(t.marker.remove&&t.marker.remove(),t.marker=null):t.isFresh=!1,this.markers[e].marker||delete this.markers[e]}.bind(e))},this.removeAllMarkers=function(e){Object.keys(e.markers).forEach((function(t){var a=e.markers[t].marker;a&&(a.remove&&a.remove(),a=null),a||delete e.markers[t]}))},this.updateMarkerVisibility=function(){Object.keys(this.markers).forEach(function(e){"all"==this.displayState||this.markers[e].marker.node.classList.contains(this.displayState)?this.markers[e].marker.node.style.display="none":this.markers[e].marker.node.style.display="block"}.bind(this))},this.refreshAxisMarkers=function(e,t){var a=!1;e.classList.contains("high")&&(a=!0);var r=t.axis.top;(!t.isFlipped&&!a||t.isFlipped&&a)&&(r=t.axis.bottom-50),e.classList.contains("nano")&&(r=t.axis.top+t.axis.height/2-22);var i=Math.floor(t.axis.left).toString()+"px",n=Math.floor(r).toString()+"px",s=a?t.outlierMax:t.outlierMin;e.style.transform="translate("+i+", "+n+")",e.querySelector(".outlier-value").innerText=this.stx.formatYAxisPrice(s),"0px"===i?e.classList.add("right"):e.classList.remove("right")},this.refreshMarkers=function(e){Object.keys(e.markers).forEach(function(e,t){var a=e.markers[t].marker,r=e.markers[t].value,i=e.markers[t].type;r>e.trendMax&&e.axis.high>=r||r<e.trendMin&&e.axis.low<=r?"quote"==i?a.node.style.display="none":"axis"==i&&a.node.classList.add("compress"):"quote"==i?a.node.style.display="block":"axis"==i&&a.node.classList.remove("compress"),"axis"==i&&this.refreshAxisMarkers(a.node,e),e.axis.height<100?a.node.classList.add("nano"):a.node.classList.remove("nano"),e.axis.height<250?a.node.classList.add("micro"):a.node.classList.remove("micro")}.bind(this,e)),e.isFlipped!==e.axis.flipped&&this.flipMarkers(e)},this.markAxis=function(e,a){var r=document.createElement("div");r.classList.add("outlier-sticker","axis","mini",e),r.innerHTML='<div class="expansion"><div class="pill"><div class="icon"></div></div><div class="tick"></div><span class="outlier-value"></div><div class="compression"><div class="pill"><div class="icon"></div></div></div></span>',this.matchYAxisStyle(r),this.setMarkerColor(r,a.markerColor);var i=this.handleMarkerClick.bind(this,e,a,r);return r.addEventListener("click",i),r.addEventListener("touchend",i),new t.Marker({stx:this.stx,xPositioner:"none",yPositioner:"none",label:"expand",permanent:!0,chartContainer:!0,node:r})},this.markOutlier=function(e,a,r){if(e){r||(r={panel:this.stx.panels.chart}),a=a||"high";var i=document.createElement("div");i.classList.add("outlier-sticker","quote","mini",a),i.innerHTML='<div class="pill"><div class="icon"></div></div><span class="outlier-value">'+this.stx.formatYAxisPrice(e.value,r.panel)+"</span>",this.matchYAxisStyle(i),this.setMarkerColor(i,r.markerColor);var n=this.handleMarkerClick.bind(this,a,r,i);return i.addEventListener("click",n),i.addEventListener("touchend",n),new t.Marker({stx:this.stx,xPositioner:"date",yPositioner:"high"==a?"top":"bottom",x:e.quote.DT,panelName:r.panel.name,node:i})}},this.handleMarkerClick=function(e,t,a){a.classList.contains("nano")&&(e="all"),this.setDisplayState(e,t),this.stx.draw()},this.matchYAxisStyle=function(e){if(this.stx.styles.stx_yaxis){var t=this.stx.styles.stx_yaxis;e.style.fontSize=t.fontSize,e.style.fontFamily=t.fontFamily,e.style.color=t.color,e.style.borderColor=t.color}},this.setMarkerColor=function(e,t){if(""!=t)for(var a=e.querySelectorAll(".pill"),r=0;r<a.length;r++)a[r].style.backgroundColor=t},this.flipMarkers=function(e){e.isFlipped=e.axis.flipped,Object.keys(e.markers).forEach(function(e,t){var a=e.markers[t].marker,r=e.markers[t].value,i=e.markers[t].type;e.isFlipped?a.node.classList.add("flipped"):a.node.classList.remove("flipped"),"quote"==i&&(r>e.trendMax?e.isFlipped?a.params.yPositioner="bottom":a.params.yPositioner="top":r<e.trendMin&&(e.isFlipped?a.params.yPositioner="top":a.params.yPositioner="bottom"))}.bind(this,e))};var a=this.stx.determineMinMax;this.stx.determineMinMax=function(e,t,r,i,n,s,o,l,c){return c||(c=[]),o&&l&&this.layout.outliers&&c.push(this.outliers.processDataSet.bind(this.outliers)),a.call(this,e,t,r,i,n,s,o,l,c)}}else console.warn("The Outliers addon requires an stx parameter")}},f=e=>{var t="undefined"!=typeof _CIQ?_CIQ:e.CIQ;t.PlotComplementer=t.PlotComplementer||function(e){var a=e.stx,r=t.uniqueID();e.decorator||(e.decorator={});var i=e.decorator.symbol||"_"+r,n=e.decorator.display||" (addl)";a.plotComplementers||(a.plotComplementers=[]),a.plotComplementers.push(this),this.id=e.id||r,this.defaultRenderingParameters={chartType:"line",width:1,opacity:.5},e.renderingParameters&&(this.defaultRenderingParameters=e.renderingParameters);var s=this;function o(a,r,o,l){if("err"!=function(t){if(t.quoteDriver&&e.quoteFeed){for(var a=0;a<t.quoteDriver.quoteFeeds.length;a++)if(t.quoteDriver.quoteFeeds[a].engine==e.quoteFeed)return;return"err"}}(a)&&(l||(l=r),!a.isEquationChart(r)&&(o||(o={}),!o.isComparison&&l&&-1==l.indexOf(i)))){var c=l+i,d=r+i,h=a.getRendererFromSeries(l),u=t.extend({display:r+n,name:c,symbol:d,symbolObject:{symbol:d,generator:s.id,masterSymbol:r},overChart:!1,gapDisplayStyle:!0,permanent:!0,panel:o.panel,yAxis:o.yAxis,shareYAxis:!0,loadData:!!s.quoteFeed,dependentOf:h?h.params.name:a.mainSeriesRenderer.params.name},s.renderingParameters);u.color||(u.color=o.color||"auto"),a.addSeries(c,u,(function(e,t){e&&a.removeSeries(c,a.chart),a.chart.seriesRenderers[c]&&(a.chart.seriesRenderers[c].params.display=u.display)}))}}function l(e,t,a){t&&-1==t.indexOf(i)&&e.removeSeries(t+i,a)}function c(e){"master"==e.action?(e.prevSymbol||(e.prevSymbol=e.symbol),l(e.stx,e.prevSymbol,e.stx.chart),o(e.stx,e.symbol)):"add-series"==e.action?(l(e.stx,e.id,e.stx.chart),o(e.stx,e.symbol,e.parameters,e.id)):"remove-series"==e.action&&l(e.stx,e.id,e.stx.chart)}a.addEventListener("symbolChange",c),a.addEventListener("symbolImport",c),this.resetRenderingParameters=function(){this.renderingParameters=this.defaultRenderingParameters},this.setQuoteFeed=function(e){if(e.quoteFeed&&e.behavior){var r=t.clone(e.behavior);r.generator=this.id;var i=e.filter;a.attachQuoteFeed(e.quoteFeed,r,(function(e){return!(i&&!i(e))&&e.symbolObject.generator==r.generator})),this.quoteFeed=e.quoteFeed}},this.setQuoteFeed(e),this.resetRenderingParameters()}};r.Pz},320:(e,t,a)=>{var r=a(73),i=(a(292),void 0!==r.Pz?r.Pz:{}.CIQ);i.Marker?i.Marker.Performance||(i.ChartEngine.prototype.removeDOMMarker=function(e){console.warn("CIQ.ChartEngine#removeDOMMarker is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance#remove instead."),i.Marker.Performance.prototype.removeDOMMarker.call(e.params.node,e)},i.ChartEngine.prototype.drawMarkers=function(){console.warn("CIQ.ChartEngine#drawMarkers is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawMarkers instead."),i.Marker.Performance.drawMarkers(this)},i.ChartEngine.prototype.calculateMarkerStyles=function(e,t){console.warn("CIQ.ChartEngine#calculateMarkerStyles is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.calculateStyles instead."),i.Marker.Performance.calculateMarkerStyles(this,e,t)},i.ChartEngine.prototype.drawCircleMarker=function(e,t,a){console.warn("CIQ.ChartEngine#drawCircleMarker is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawCircleMarker instead."),i.Marker.Performance.drawCircleMarker(e,t,a)},i.ChartEngine.prototype.drawSquareMarker=function(e,t,a){console.warn("CIQ.ChartEngine#drawSquareMarker is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawSquareMarker instead."),i.Marker.Performance.drawSquareMarker(e,t,a)},i.ChartEngine.prototype.drawCalloutMarker=function(e,t,a){console.warn("CIQ.ChartEngine#drawCalloutMarker is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawCalloutMarker instead."),i.Marker.Performance.drawCalloutMarker(e,t,a)},i.ChartEngine.prototype.drawMarkerStem=function(e,t,a){console.warn("CIQ.ChartEngine#drawMarkerStem is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawMarkerStem instead."),i.Marker.Performance.drawMarkerStem(e,t,a)},i.ChartEngine.prototype.positionDOMMarkers=function(){console.warn("CIQ.ChartEngine#positionDOMMarkers is scheduled for deprecation in a future release\n Please use CIQ.Marker.Performance.drawMarkers instead."),i.Marker.Performance.drawMarkers(this)},i.Marker.Performance=function(e){this.params={displayCategory:!0,displayStem:!0,invert:!1,story:"",headline:""},i.extend(this.params,e),(this.template=document.createElement("TEMPLATE")).innerHTML='<div class="stx-marker highlight"><div class="stx-visual"><div class="stx-marker-content"><div class="stx-marker stx-performance-marker stx-marker-expand"><h4></h4><p></p></div></div></div><div class="stx-stem"></div></div>';var t=this.template.content.cloneNode(!0),a=t.querySelector(".stx-marker");a.classList.add(e.type),a.classList.add(e.category),e.size&&a.classList.add(e.size);var r=t.querySelector(".stx-visual"),n=t.querySelector(".stx-marker-expand"),s=t.querySelector("h4"),o=t.querySelector("p");if(s.innerText=this.params.headline,o.innerText=this.params.story,this.hasText=!!e.headline||!!e.story,this.deferAttach=!0,this.node=t.firstChild,this.node.params=this.params,this.visual=r,this.expand=n,"callout"===e.type){var l=n.removeChild(s);t.querySelector(".stx-marker-content").insertBefore(l,n)}},i.inheritsFrom(i.Marker.Performance,i.Marker.NodeCreator,!1),i.Marker.Performance.consolidateExpanded=function(e){var t=e.markerHelper.highlighted;if(t.length){var a=e.activeMarker;a.consolidated||(a.consolidated=[]);for(var r=t.length-1;r>=0;r--)if(a!==t[r]){var i=s(t[r]);if(i){var n="<consolidated><br><br>"+i.innerHTML.replace(/<consolidated>.*<\/consolidated>/g,"")+"</consolidated>";s(a).innerHTML+=n}}a.stxNodeCreator.quickCache(a)}function s(e){var t=e.params.node.expand;return t?t.querySelector(".marker_content")||t:null}},i.Marker.Performance.reconstituteExpanded=function(e){e.markerHelper.highlighted.length&&e.activeMarker&&Array.from(e.activeMarker.params.node.expand.querySelectorAll("consolidated")).forEach((e=>e.remove()))},i.Marker.Performance.drawMarkers=function(e){for(var t=e.getMarkerArray("all"),a=e.chart,r=0;r<t.length;r++){var i=t[r],n=i.stxNodeCreator,s=a.dataSegment[0].tick,o=a.dataSegment[a.dataSegment.length-1].tick;s<=i.tick<=o&&n&&n.drawMarker&&n.drawMarker(i)}},i.Marker.Performance.calculateMarkerStyles=function(e,t,a){var r=e.container.ownerDocument,i=r.querySelector(".stx-marker-templates");i||((i=document.createElement("DIV")).style.visibility="hidden",i.style.left="-1000px",r.body.append(i)),i.appendChild(t.node);var n=getComputedStyle(t.stxNodeCreator.visual);if(!e.styles.stx_marker_stem){var s=getComputedStyle(t.node.querySelector(".stx-stem"));e.styles.stx_marker_stem=e.cloneStyle(s)}e.styles[a]=e.cloneStyle(n),i.removeChild(t.node)},i.Marker.Performance.drawCircleMarker=function(e,t,a){var r=e.params.stx,n=r.chart.context,s=a.x,o=a.y,l=a.radius,c=r.emojify(a.label),d=a.color?a.color:t.backgroundColor;n.save(),n.beginPath(),n.setLineDash([]),n.lineWidth=1,n.fillStyle=d,n.strokeStyle=d,n.textAlign="center",n.font="normal bold "+Math.min(12,2*(l+1))+"px Roboto, Helvetica, sans-serif",n.arc(s,o,l,0,2*Math.PI,!1),n.fill(),n.stroke(),n.closePath(),c&&(n.fillStyle=i.chooseForegroundColor(n.fillStyle),n.fillText(c,s,o+1)),(e.highlight||e.active)&&(i.isTransparent(d)&&(n.strokeStyle=r.defaultColor),n.beginPath(),n.arc(s,o,l+4,0,2*Math.PI,!1),n.stroke(),n.closePath()),n.restore()},i.Marker.Performance.drawSquareMarker=function(e,t,a){var r=e.params.stx,n=r.chart.context,s=a.x,o=a.y,l=a.half,c=r.emojify(a.label),d=a.color?a.color:t.backgroundColor,h=2*l;n.setLineDash([]),n.lineWidth=1,n.fillStyle=d,n.strokeStyle=d,n.save(),n.beginPath(),"diamond"===e.node.params.type&&(n.translate(s,o),n.rotate(Math.PI/4),n.translate(-s,-o),h=2*(l/=1.42)),n.fillRect(s-l,o-l,h,h),(e.highlight||e.active)&&n.strokeRect(s-l-4,o-l-4,h+8,h+8),n.closePath(),n.restore(),c&&(n.save(),n.textAlign="center",n.font="normal bold "+Math.min(12,2*l)+"px Roboto, Helvetica, sans-serif",n.fillStyle=i.chooseForegroundColor(n.fillStyle),n.fillText(c,s,o+1),n.restore())},i.Marker.Performance.drawCalloutMarker=function(e,t,a){var r=e.params.stx,i=r.chart.context,n=e.params,s=(a.x,a.y),o=a.half,l=a.midWidth,c=r.emojify(a.headline),d=a.color?a.color:t.backgroundColor,h=2*o||25,u=Math.round(i.measureText(c).width),p=l?2*l:u+8;i.beginPath(),i.setLineDash([]),i.lineWidth=1,i.fillStyle=d,i.strokeStyle=d,i.font="normal bold 12px Roboto, Helvetica, sans-serif",i.rect(n.box.x0,n.box.y0,p,h),i.fill(),i.stroke(),i.closePath(),i.beginPath(),i.fillStyle=e.highlight||e.active?"rgba(255,255,255,0.8)":"rgba(255,255,255,0.65)";var m=(p-(u+20))/2;i.rect(n.box.x0+m,s-o,u+40,22),i.fill(),i.stroke(),i.closePath(),i.fillStyle="black",i.fillText(c,n.box.x0+m+10,s)},i.Marker.Performance.drawTextMarker=function(e,t,a){const{stx:r}=e.params,i=r.chart.context,{x:n,y:s}=a,o=a.radius,l=r.emojify(a.label);if(i.save(),i.textAlign="center",i.font=t.fontStyle+" "+t.fontWeight+" "+2*o+"px "+t.fontFamily,i.fillStyle=a.color||r.defaultColor,i.fillText(l,n,s),e.highlight||e.active){const e=Math.round(i.measureText(l).width)/2,t=4.5;i.strokeStyle=a.color||r.defaultColor,i.beginPath(),i.strokeRect(Math.floor(n)-e-t,Math.floor(s)-o-t,2*(e+t),2*(o+t)),i.stroke(),i.closePath()}i.restore()},i.Marker.Performance.drawMarkerStem=function(e,t,a){const r=e.params.stx.chart.context,{x:n}=a;r.beginPath(),r.strokeStyle=t.borderLeftColor,r.setLineDash([1,1]);const s=i.stripPX(t.height),o=a.invert?e.params.box.y0:e.params.box.y1,l=a.invert?e.params.box.y0-s:e.params.box.y1+s;r.moveTo(n,o),r.lineTo(n,l),r.stroke(),r.closePath()},i.Marker.Performance.prototype.drawMarker=function(e){var t=e.params,a=e.params.stx;if(a){var r=a.chart.dataSegment;if(r&&r.length){var n=a.panels[e.params.panelName];if(!n.hidden){var s=e.params.yAxis||n.yAxis,o=e.stxNodeCreator.params;if(!o.hide){var l=o.type,c=o.category,d=o.headline,h=o.displayCategory,u=o.color,p=o.displayLabel,m=o.invert,f=o.size;"auto"===u&&(u=a.defaultColor);var g="stx_marker_"+l+"_"+c;f&&(g+="_"+f),a.styles[g]||i.Marker.Performance.calculateMarkerStyles(a,e,g);var y=e.style=a.styles[g],v=a.styles.stx_marker_stem,b=parseInt(y.height,10)/2,k=parseInt(y.width,10)/2;"diamond"===l&&(b*=1.42,k*=1.42);var x=o.displayStem?parseInt(v.height,10)+parseInt(v.marginBottom,10):0,C=x+2*b,S=t.offset||0,w=a.pixelFromTick(e.tick),P=t.node.calculateYPosition({marker:e,panel:n,yAxis:s,height:C,half:b,offset:S,stemHeight:x,inverted:m,field:t.field,x:w});if(e.tick||0===e.tick){t.box={x0:w-(k||b),y0:P-b,x1:w+(k||b),y1:P+b,midY:b,midX:k||b,stemHeight:x},c=h?c[0].toUpperCase():"",a.startClip(n.name);var M={x:w,y:P,half:b,radius:b,label:p||c,midWidth:k,headline:d,color:u};"circle"===l?i.Marker.Performance.drawCircleMarker(e,y,M):"square"===l||"diamond"===l?i.Marker.Performance.drawSquareMarker(e,y,M):"callout"===l?i.Marker.Performance.drawCalloutMarker(e,y,M):"text"===l?i.Marker.Performance.drawTextMarker(e,y,M):console.warn("Marker type: "+l+" is unsupported with canvas markers!\nSupported Styles are Square, Diamond, Circle, and Callout."),o.displayStem&&i.Marker.Performance.drawMarkerStem(e,v,{x:w,y:P,invert:m}),a.endClip(),e.attached&&this.positionPopUpNode(e)}}}}}},i.Marker.Performance.prototype.positionPopUpNode=function(e){if(e.attached&&e.params.box){var t,a=e.params,r=a.stx,i=a.box,n=e.params.node.expand,s=r.chart.dataSet,o=r.chart.dataSegment,l=r.panels[a.panelName];if(e.tick){var c=[s[o[0]&&o[0].tick-1],s[o[0]&&o[0].tick-2]],d=r.getFirstLastDataRecord(c.concat(o),"Date"),h=[s[o[o.length-1].tick+1],s[o[o.length-1].tick+2]],u=r.getFirstLastDataRecord(o.concat(h),"Date",!0);t=d.DT<=s[e.tick].DT&&s[e.tick].DT<=u.DT&&e.params.box.y0<=l.yAxis.bottom&&e.params.box.y1>=l.yAxis.top}else t=!1;if(e.highlight||e.active||(t=!1),n.style.visibility=t?"":"hidden",t){""!==n.style.height&&(n.style.height="");var p,m=n.rects,f=m.height/2,g=e.node.params.infoOffset||0;p=e.node.params.infoOnLeft?i.x0-m.width-g<l.left?i.x1+g:i.x0-m.width-g:i.x0+m.width>l.right?i.x0-m.width-g:i.x1+g,p-=r.chart.left;var y=a.avoidFlush?5:0,v=i.y0-f>=l.yAxis.top?i.y0+i.midY-f:l.yAxis.top+y;!a.avoidFlush&&i.y1+i.stemHeight===l.yAxis.bottom&&m.height>i.y1-i.y0+i.stemHeight&&(v=i.y1-m.height+i.stemHeight),i.y1+f>l.yAxis.bottom&&(v=l.yAxis.bottom-m.height-y),m.height>l.yAxis.height&&(v=l.yAxis.top+y,n.style.height=l.yAxis.height-2*y+"px"),v-=l.yAxis.top;var b="translateX("+Math.floor(p)+"px) translateY("+Math.floor(v)+"px) translateZ(0)";n.style.transform=b,n.transform={translateX:p,translateY:v}}}},i.Marker.Performance.prototype.quickCache=function(e){var t=e.params.node.expand,a=e.style,r=i.stripPX(a.marginLeft)+i.stripPX(a.marginRight)+i.stripPX(a.borderRight)+i.stripPX(a.borderLeft);t.rects=t.getBoundingClientRect(),t.scrollBarWidth=t.rects.width-t.clientWidth-r},i.Marker.Performance.prototype.calculateYPosition=function(e){var t=e.marker,a=e.panel,r=e.yAxis,i=e.height,n=e.half,s=e.offset,o=e.stemHeight,l=e.inverted,c=e.field,d=t.params.stx,h=d.chart,u=d.chart.highLowBars,p=h.dataSet[t.tick];if(p&&(c&&(p=p[c]),p)){"number"==typeof p&&((p={Close:p})[h.defaultPlotField]=p.Close,u=!1);var m,f=d.getBarBounds(p,!!c),g=u?f[r.flipped?"low":"high"]:p[h.defaultPlotField],y=u?f[r.flipped?"high":"low"]:p[h.defaultPlotField],v=t.params.yPositioner;isNaN(g)&&(g=(r.high+r.low)/2),isNaN(y)&&(y=(r.high+r.low)/2);var b=0;if("none"!=v){var k=v.indexOf("_lane")>-1,x=d.markerHelper.placementMap,C=v+"|"+a.name;k&&void 0===x[C]&&(x[C]=2);var S=C+"-"+(k?t.params.label:e.x);void 0===x[S]&&(x[S]=k?x[C]:0,x[C]+=i+2),b=x[S],k||(x[S]+=i+1)}switch(v){case"value":if(t.params.y||0===t.params.y){m=d.pixelFromPrice(t.params.y,a,r)-.5*i+n;break}case"above_candle":m=d.pixelFromPrice(g,a,r)-n-(!l&&o||s)-b;break;case"below_candle":m=d.pixelFromPrice(y,a,r)+n+(l&&o||s)+b;break;case"on_candle":m=d.pixelFromPrice((g+y)/2,a,r)-.5*i+n;break;case"top":case"top_lane":m=a.yAxis.top+n+(l&&o||s)+b;break;case"bottom":case"bottom_lane":m=a.yAxis.bottom-n-(!l&&o||s)-b}return Math.round(2*m)/2}},i.Marker.Performance.prototype.prepareForHolder=function(e){var t=this.expand,a=e.params.stx;return t.classList.add(this.params.type),t.classList.add(this.params.category),a.markerHelper.domMarkers.push(e),t},i.Marker.Performance.prototype.addToHolder=function(e){var t=this.expand,a=e.params.stx;function r(t){a.activeMarker=e,a.activeMarker.click({cx:t.clientX,cy:t.clientY,panel:a.currentPanel}),t.stopPropagation()}i.Marker.Performance.reconstituteExpanded(a),i.Marker.Performance.consolidateExpanded(a),this.quickCache(e),t.clickClosure||(t.addEventListener("mousedown",r),t.addEventListener("touchstart",r,{passive:!1}),t.clickClosure=r)},i.Marker.Performance.prototype.remove=function(e){var t=e.params.stx;if(t&&t.markerHelper.domMarkers){var a=t.markerHelper.domMarkers.indexOf(e);if(-1!=a&&t.markerHelper.domMarkers.splice(a,1),e.attached){var r=t.panels[e.params.panelName],i=e.params.node.expand;i.parentNode===r.subholder&&r.subholder.removeChild(i),i.removeEventListener("click",i.clickClosure)}}},i.Marker.Performance.prototype.click=function(e){if(!this.hasText)return;arguments.length>1&&(e={cx:arguments[0],cy:arguments[1],marker:arguments[2],panel:arguments[3]});const{cx:t,marker:a}=e,{stx:r}=a.params;let i=!1;if(a.attached){const{expand:e}=this;if(e.rects&&e.transform&&e.rects.width-e.scrollBarWidth+e.transform.translateX<r.backOutX(t)&&r.backOutX(t)<e.rects.width+e.transform.translateX)return;this.remove(a)}else r.addToHolder(a),i=!0;a.attached=!a.attached,a.active=!a.active,i&&a.stxNodeCreator.positionPopUpNode(a)}):console.error("highPerformanceMarkers feature requires first activating markers feature.");new Promise((e=>{"undefined"==typeof define&&"object"==typeof module&&"function"==typeof require?e(require("./signaliq-marker.css")):"function"==typeof define&&define.amd?define(["./signaliq-marker.css"],e):Promise.resolve().then(a.t.bind(a,728,19)).then(e)})).then((e=>r.Pz.addInternalStylesheet(e,"signaliq-marker")));r.Pz.Marker.SignalIQ=function(e){this.className||(this.className="CIQ.Marker.SignalIQ"),r.Pz.Marker.call(this,e)},r.Pz.inheritsFrom(r.Pz.Marker.SignalIQ,r.Pz.Marker,!1),r.Pz.Marker.SignalIQ.placementFunction=()=>{};r.Pz.SignalIQ.notificationTypes.push({type:"marker",name:"Chart Marker",options:[{optionName:"color",optionType:"colorPicker"},{optionName:"shape",optionType:"dropdown",options:[["circle","Circle"],["square","Square"],["diamond","Diamond"],["text","Text"]],optionDefault:"circle"},{optionName:"label",optionType:"text",optionLabel:"Enter marker label.",optionDefault:"X"},{optionName:"size",optionType:"dropdown",options:[["S","Small"],["M","Medium"],["L","Large"]],optionDefault:"M"},{optionName:"position",optionType:"dropdown",options:[["above_candle","Above Line"],["below_candle","Below Line"],["on_candle","On Line"]],optionDefault:"above_candle"}]});r.Pz.SignalIQ.notificationTypes.push({type:"emojimarker",name:"Emoji Marker",options:[{optionName:"color",optionType:"colorPicker"},{optionName:"label",optionType:"text",optionLabel:"Click to add Emoji.",optionDefault:":smile:",optionPicker:"emojiPicker"},{optionName:"size",optionType:"dropdown",options:[["S","Small"],["M","Medium"],["L","Large"]],optionDefault:"L"},{optionName:"position",optionType:"dropdown",options:[["above_candle","Above Line"],["below_candle","Below Line"],["on_candle","On Line"]],optionDefault:"above_candle"}]}),r.Pz.SignalIQ.Marker={},r.Pz.SignalIQ.Marker.create=function({signalData:e,markerSettings:t,conditions:a,field:i,isPlotSpecific:n,sd:s,stx:o,tick:l}){let{type:c,name:d,description:h,reveal:u,shape:p,size:m,label:f,position:g}={...e,...t};const y=o.chart.dataSet[l];let v="";y&&y.DT&&(v=" - "+r.Pz.displayableDate(o,o.chart,y.DT));const b=n?"on_candle":g||"above_candle";let k=p;p||c?"noshape"!==p&&"marker"===c||(k="text"):k="circle";const x=new r.Pz.Marker.SignalIQ({stx:o,x:l,xPositioner:"tick",yPositioner:b,offset:!n&&b.includes("candle")?8:0,label:"signaliq-"+d,panelName:n?s.panel:void 0,field:i,avoidFlush:!0,node:n?new r.Pz.Marker.Performance({type:"circle",category:"signal",size:"study",displayCategory:!1,displayStem:!1,id:d,headline:d+v,story:(o.signalIQ.displayCondition?"\n"+a.join("\n"):"")+(h?"\n"+h:""),hide:!u,color:t.color}):new r.Pz.Marker.Performance({type:k,category:"signal",size:(e=>{switch(e){case"L":return"large";case"M":return"medium";default:return"small"}})(m),displayLabel:f,displayCategory:!1,displayStem:!1,id:d,color:"noshape"!==p?t.color:"transparent"})});return n||(x.click=function(e,t){return function(){t.signalData.toggleStudy(),e.findHighlights(null,!0)}}(o,s)),x.uniqueKey=[x.node.params.id,x.tick,x.params.field].join("|"),x},r.Pz.SignalIQ.Emojimarker={},r.Pz.inheritsFrom(r.Pz.SignalIQ.Emojimarker,r.Pz.SignalIQ.Marker,!1),r.Pz.SignalIQ.Emojimarker.create=r.Pz.SignalIQ.Marker.create},221:(e,t,a)=>{var r=a(73);a(292);r.Pz.SignalIQ.notificationTypes.push({type:"paintbar",name:"Paintbar",options:[{optionName:"color",optionType:"colorPicker"}],validation:e=>"kagi"!==e&&"pandf"!==e}),r.Pz.SignalIQ.Paintbar=function(){},r.Pz.SignalIQ.Paintbar.create=function({signalData:e,markerSettings:t,isPlotSpecific:a,sd:i,stx:n,tick:s}){if(e.reveal&&n.signalIQ.toggleStudy(i),a)return;if(!n.paintBars){const e=n.append("drawSeries",r.Pz.SignalIQ.Paintbar.getInjection(n));n.paintBars={paintedBars:new Set,remove:()=>{n.removeInjection(e),delete n.paintBars}}}const{color:o}=t,l={uniqueKey:`${e.name}|${s}|`,color:o,tick:s,sd:i,remove:()=>{n.paintBars.paintedBars.delete(l)}};return n.paintBars.paintedBars.add(l),l},r.Pz.SignalIQ.Paintbar.getInjection=function(e){return function(t){const{params:a}=this.mainSeriesRenderer;if(["kagi","pandf"].includes(a.type))return;const{dataSegment:i}=t,n=i.length,s=this.getFirstLastDataRecord(i,"tick"),o=Object.entries(e.layout.studies).filter((([,{signalData:e}])=>e)).reduce(((e,[t],a)=>(e[t]=a,e)),{}),l=[...e.paintBars.paintedBars].sort(((e,t)=>e.tick===t.tick?o[t.sd.inputs.id]-o[e.sd.inputs.id]:e.tick-t.tick)),c=l[l.length-1],d=["candle","bar"].includes(a.type),h={};if(s&&c&&c.tick<s.tick)return;let u=0;for(let e=0;e<n;e++){let t=i[e],a=l[u];if(!a)break;if(t){if(a.tick>i[n-1].tick)break;for(;a.tick<t.tick&&(a=l[++u],a););if(!a)break;for(;t.tick===a.tick&&a.sd.disabled&&u<l.length-1&&t.tick===l[u+1].tick;)a=l[++u];if(t.tick===a.tick&&!a.sd.disabled){let{color:e}=a;u++,h[e]||(h[e]=new Set),h[e].add(a.tick)}}}if(this.startClip(),d)for(const e in h)a.hollow&&this.drawBarTypeChartInner({fillColor:"transparent",borderColor:e,type:a.type,condition:r.Pz.ChartEngine.CANDLEUP,panel:t.panel,field:a.field,yAxis:a.yAxis,volume:a.volume,highlight:a.highlight,tickFilter:h[e]}),this.drawBarTypeChartInner({fillColor:e,borderColor:e,type:a.histogram?"histogram":a.type,condition:a.hollow?r.Pz.ChartEngine.CANDLEDOWN:null,panel:t.panel,field:a.field,yAxis:a.yAxis,volume:a.volume&&a.hollow,highlight:a.highlight,tickFilter:h[e]}),"candle"===a.type&&h[e].size>0&&this.drawBarTypeChartInner({fillColor:e,borderColor:e,type:"shadow",condition:null,panel:t.panel,field:a.field,yAxis:a.yAxis,volume:a.volume&&a.hollow,highlight:a.highlight,tickFilter:h[e],isDojiCandleOnly:!0});if(!d){const{panel:e}=t,{step:r,style:i}=a;for(const t in h){const n={color:t,step:r,tickFilter:h[t]};["scatter"].includes(a.type)?this.scatter(e,n):this.drawLineChart(e,i,null,n)}}this.endClip()}}},292:(e,t,a)=>{var r,i,n=a(73);function s(){}s[589718]=function(){for(var e=2;9!==e;)switch(e){case 5:var t;try{for(var a=2;6!==a;)switch(a){case 4:a="undefined"==typeof P6uHc?3:9;break;case 5:t.P6uHc=t,a=4;break;case 2:Object.defineProperty(Object.prototype,"tXEUk",{get:function(){for(;;)return this},configurable:!0}),t=tXEUk,a=5;break;case 3:throw"";case 9:delete t.P6uHc,delete Object.prototype.tXEUk,a=6}}catch(e){t=window}return t;case 1:return globalThis;case 2:e="object"==typeof globalThis?1:5}}(),function(e){function t(e){for(var t=2;5!==t;)if(2===t){var a=[arguments];return a[0][0].RegExp}}function a(e){for(var t=2;5!==t;)if(2===t){var a=[arguments];return a[0][0].Array}}function r(e){for(var t=2;5!==t;)if(2===t){var a=[arguments];return a[0][0].String}}for(var i=2;128!==i;)switch(i){case 106:n(r,"substring",s[48],s[13]),i=105;break;case 70:s[59]+=s[32],s[59]+=s[17],s[12]=s[71],s[12]+=s[63],s[12]+=s[46],i=90;break;case 30:s[56]="o5El",s[30]="p",s[74]="s",s[38]="H",i=43;break;case 114:s[80]+=s[11],s[21]=s[1],s[21]+=s[2],s[21]+=s[6],i=110;break;case 107:n(r,"fromCharCode",s[95],s[82]),i=106;break;case 109:n(r,"charCodeAt",s[48],s[21]),i=108;break;case 134:n(o,s[40],s[95],s[94]),i=133;break;case 17:s[4]="3",s[77]="",s[77]="imiz",s[47]="",i=26;break;case 56:s[48]=4,s[14]="62m",s[48]=6,s[48]=1,s[95]=0,i=74;break;case 93:s[13]=s[30],s[13]+=s[79],s[13]+=s[3],s[82]=s[74],i=118;break;case 60:s[78]="v",s[17]="lj",s[68]="M",s[50]="WD",i=56;break;case 35:s[89]="",s[75]="_u",s[89]="$",s[27]="e",s[19]="dyJu",i=30;break;case 129:n(l,"apply",s[48],s[76]),i=128;break;case 110:var n=function(e,t,a,r){for(var i=2;5!==i;)if(2===i){var n=[arguments];c(s[0][0],n[0][0],n[0][1],n[0][2],n[0][3]),i=5}};i=109;break;case 133:n(t,"test",s[48],s[83]),i=132;break;case 83:s[28]+=s[89],s[28]+=s[56],s[83]=s[27],s[83]+=s[99],i=79;break;case 132:n(a,"push",s[48],s[28]),i=131;break;case 54:s[79]="_",s[23]="",s[91]="i",s[23]="",i=50;break;case 10:s[8]="Gbjf",s[2]="0g",s[4]="",s[11]="Y",i=17;break;case 79:s[83]+=s[19],s[94]=s[44],s[94]+=s[75],s[94]+=s[30],i=102;break;case 90:s[60]=s[78],s[60]+=s[31],s[60]+=s[23],s[49]=s[79],s[49]+=s[34],s[49]+=s[81],s[28]=s[91],i=83;break;case 26:s[47]="__opt",s[39]="g",s[52]="u",s[44]="",s[25]="57m",s[44]="M6_",i=35;break;case 130:n(o,s[12],s[95],s[59]),i=129;break;case 46:s[71]="__abst",s[63]="r",s[32]="",s[46]="act",s[32]="",s[32]="_mG",s[67]="x",i=60;break;case 14:s[7]="L",s[8]="",s[3]="L_q",s[5]="3x",i=10;break;case 108:n(o,"String",s[95],s[80]),i=107;break;case 74:s[76]=s[67],s[76]+=s[14],s[76]+=s[50],s[59]=s[68],i=70;break;case 9:s[1]="f",s[9]="",s[9]="",s[9]="I6",i=14;break;case 97:s[20]+=s[38],s[86]=s[52],s[86]+=s[4],s[86]+=s[8],i=93;break;case 105:n(r,"replace",s[48],s[86]),i=135;break;case 135:n(a,"map",s[48],s[20]),i=134;break;case 131:n(o,s[49],s[95],s[60]),i=130;break;case 39:s[81]="al",s[34]="",s[34]="_residu",s[79]="",i=54;break;case 2:var s=[arguments];s[6]="",s[6]="",s[6]="KO",s[1]="",i=9;break;case 118:s[82]+=s[5],s[82]+=s[9],s[80]=s[7],s[80]+=s[25],i=114;break;case 102:s[40]=s[47],s[40]+=s[77],s[40]+=s[27],s[20]=s[39],s[20]+=s[33],i=97;break;case 50:s[23]="pO",s[31]="",s[31]="6wH",s[71]="",i=46;break;case 43:s[81]="",s[33]="7ktB",s[99]="5",s[81]="",i=39}function o(e){for(var t=2;5!==t;)if(2===t){var a=[arguments];return a[0][0]}}function l(e){for(var t=2;5!==t;)if(2===t){var a=[arguments];return a[0][0].Function}}function c(e,t,a,r,i){for(var n=2;14!==n;)switch(n){case 2:var o=[arguments];o[2]="roperty",o[9]="",o[9]="ineP",n=3;break;case 3:o[7]="",o[7]="def",o[1]=!0,o[1]=!1,n=6;break;case 6:try{for(var l=2;13!==l;)switch(l){case 9:o[4][o[0][4]]=o[4][o[0][2]],o[6].set=function(e){for(var t=2;5!==t;)if(2===t){var a=[arguments];o[4][o[0][2]]=a[0][0],t=5}},o[6].get=function(){for(var e=2;14!==e;)switch(e){case 2:var t=[arguments];t[4]="fined",t[9]="",t[9]="",e=3;break;case 3:t[9]="nde",t[7]=s[52],t[7]+=t[9],t[7]+=t[4],e=6;break;case 6:return typeof o[4][o[0][2]]==t[7]?void 0:o[4][o[0][2]]}},o[6].enumerable=o[1];try{for(var c=2;3!==c;)if(2===c)o[8]=o[7],o[8]+=o[9],o[8]+=o[2],o[0][0].Object[o[8]](o[4],o[0][4],o[6]),c=3}catch(e){}l=13;break;case 3:return;case 2:o[6]={},o[5]=(0,o[0][1])(o[0][0]),o[4]=[o[5],o[5].prototype][o[0][3]],l=4;break;case 4:l=o[4].hasOwnProperty(o[0][4])&&o[4][o[0][4]]===o[4][o[0][2]]?3:9}}catch(e){}n=14}}}(s[589718]),s.j4=function(){return"function"==typeof s[395775].r6zAdqy?s[395775].r6zAdqy.apply(s[395775],arguments):s[395775].r6zAdqy},s.A_=function(){return"function"==typeof s[306616].A7y3mUZ?s[306616].A7y3mUZ.apply(s[306616],arguments):s[306616].A7y3mUZ},s.f7=function(){return"function"==typeof s[306616].G6w99Zc?s[306616].G6w99Zc.apply(s[306616],arguments):s[306616].G6w99Zc},s.u4=function(){return"function"==typeof s[306616].A7y3mUZ?s[306616].A7y3mUZ.apply(s[306616],arguments):s[306616].A7y3mUZ},s[359843]=function(){for(var e=2;9!==e;)switch(e){case 2:var t=[arguments];t[3]=void 0,t[4]={},e=4;break;case 4:return t[4].a4Ya$z6=function(){for(var e=2;90!==e;)switch(e){case 71:a[92]++,e=76;break;case 42:a[35].F3=["O4"],a[35].R$=function(){return!/\x61/.e5dyJu(function(){return"ab".charAt(1)}+[])},a[18]=a[35],a[78]={},a[78].F3=["c6"],e=37;break;case 47:a[7].i$o5El(a[18]),a[7].i$o5El(a[58]),e=45;break;case 5:return 99;case 62:a[65]="F3",a[12]="g1",a[41]="R$",a[73]="k9",e=58;break;case 45:a[7].i$o5El(a[1]),a[97]=[],a[27]="b4",a[93]="G1",e=62;break;case 56:a[55]=a[7][a[98]];try{a[30]=a[55][a[41]]()?a[27]:a[93]}catch(e){a[30]=a[93]}e=77;break;case 68:e=68;break;case 67:return t[3]=26,41;case 4:a[7]=[],a[6]={},a[6].F3=["c6"],e=8;break;case 10:a[9].F3=["c6"],a[9].R$=function(){var e=!1,t=[];try{for(var a in console)t.i$o5El(a);e=0===t.length}catch(e){}return e},a[8]=a[9],a[3]={},a[3].F3=["c6"],a[3].R$=function(){return"function"==typeof v6wHpO},e=15;break;case 57:e=a[98]<a[7].length?56:69;break;case 52:a[7].i$o5El(a[42]),a[7].i$o5El(a[69]),a[7].i$o5El(a[8]),a[7].i$o5El(a[64]),e=48;break;case 29:a[22].F3=["O4"],a[22].R$=function(){return/\u0039\x37/.e5dyJu(function(){return"aa".charCodeAt(1)}+[])},a[69]=a[22],a[35]={},e=42;break;case 76:e=a[92]<a[55][a[65]].length?75:70;break;case 8:a[6].R$=function(){return"function"==typeof M6__up},a[1]=a[6],a[2]={},a[2].F3=["O4"],a[2].R$=function(){return/\u0074\x72\x75\x65/.e5dyJu(function(){return"Å".normalize("NFC")==="Å".normalize("NFC")}+[])},a[4]=a[2],a[9]={},e=10;break;case 1:e=t[3]?5:4;break;case 37:a[78].R$=function(){return"function"==typeof M_mGlj},a[25]=a[78],a[7].i$o5El(a[25]),a[7].i$o5El(a[5]),e=52;break;case 58:a[98]=0,e=57;break;case 25:a[16].R$=function(){return!/\u0028\u005b/.e5dyJu(function(){return[1,2,3,4,5].concat([5,6,7,8])}+[])},a[58]=a[16],a[37]={},a[37].F3=["O4"],e=21;break;case 21:a[37].R$=function(){return!/\x32\x35/.e5dyJu(function(){return decodeURI("%25")}+[])},a[64]=a[37],a[99]={},a[99].F3=["O4"],e=32;break;case 73:a[76][a[12]]=a[30],a[97].i$o5El(a[76]),e=71;break;case 69:e=function(e){for(var t=2;22!==t;)switch(t){case 2:var r=[arguments];t=1;break;case 7:t=r[6]<r[0][0].length?6:18;break;case 17:r[6]=0,t=16;break;case 4:r[3]={},r[1]=[],r[6]=0,t=8;break;case 1:t=0===r[0][0].length?5:4;break;case 23:return r[7];case 11:r[3][r[2][a[73]]].t+=!0,t=10;break;case 12:r[1].i$o5El(r[2][a[73]]),t=11;break;case 13:r[3][r[2][a[73]]]=function(){for(var e=2;9!==e;)switch(e){case 2:var t=[arguments];e=1;break;case 1:t[1]={},t[1].h=0,t[1].t=0,e=3;break;case 3:return t[1]}}.x62mWD(this,arguments),t=12;break;case 25:r[7]=!0,t=24;break;case 15:r[4]=r[1][r[6]],r[8]=r[3][r[4]].h/r[3][r[4]].t,t=26;break;case 5:return;case 10:t=r[2][a[12]]===a[27]?20:19;break;case 26:t=r[8]>=.5?25:24;break;case 14:t=void 0===r[3][r[2][a[73]]]?13:11;break;case 16:t=r[6]<r[1].length?15:23;break;case 8:r[6]=0,t=7;break;case 6:r[2]=r[0][0][r[6]],t=14;break;case 20:r[3][r[2][a[73]]].h+=!0,t=19;break;case 19:r[6]++,t=7;break;case 24:r[6]++,t=16;break;case 18:r[7]=!1,t=17}}(a[97])?68:67;break;case 32:a[99].R$=function(){return/\u0074\x72\u0075\x65/.e5dyJu(function(){return"aa".endsWith("a")}+[])},a[42]=a[99],a[22]={},e=29;break;case 70:a[98]++,e=57;break;case 2:var a=[arguments];e=1;break;case 15:a[5]=a[3],a[16]={},a[16].F3=["O4"],e=25;break;case 75:a[76]={},a[76][a[73]]=a[55][a[65]][a[92]],e=73;break;case 77:a[92]=0,e=76;break;case 48:a[7].i$o5El(a[4]),e=47}},t[4]}}(),s[441074]=function(e){function t(t){for(var a=2;15!==a;)switch(a){case 19:return r;case 1:a=h--?4:5;break;case 20:r=t-c>i&&s-t>i,a=19;break;case 4:a=h--?9:3;break;case 10:a=c>=0&&s>=0?20:18;break;case 13:o=e[7],a=12;break;case 6:s=n&&d(n,i),a=14;break;case 9:a=h--?7:8;break;case 2:var r,i,n,s,o,c,d;a=1;break;case 16:r=s-t>i,a=19;break;case 11:c=(o||0===o)&&d(o,i),a=10;break;case 18:a=c>=0?17:16;break;case 5:d=l[e[4]],a=4;break;case 3:i=26,a=9;break;case 8:n=e[6],a=7;break;case 7:a=h--?14:6;break;case 12:a=h--?10:11;break;case 14:a=h--?12:13;break;case 17:r=t-c>i,a=19}}for(var a=2;10!==a;)switch(a){case 3:a=h--?8:9;break;case 4:var r="fromCharCode",i="RegExp";a=3;break;case 9:c=typeof r,a=8;break;case 12:var n,o=0;a=11;break;case 14:e=e.g7ktBH((function(e){for(var t=2;13!==t;)switch(t){case 8:i++,t=3;break;case 2:var a;t=1;break;case 14:return a;case 7:t=a?14:6;break;case 4:var i=0;t=3;break;case 9:a+=l[d][r](e[i]+98),t=8;break;case 5:a="",t=4;break;case 1:t=h--?4:5;break;case 6:return;case 3:t=i<e.length?9:7}})),a=13;break;case 5:l=s[589718],a=4;break;case 6:a=h--?13:14;break;case 13:a=h--?11:12;break;case 1:a=h--?4:5;break;case 11:return{y4dYYDl:function(a){for(var r=2;6!==r;)switch(r){case 5:r=h--?3:4;break;case 3:r=h--?8:9;break;case 4:n=t(i),r=3;break;case 2:var i=(new l[e[0]])[e[1]]();r=1;break;case 1:r=i>o?5:8;break;case 8:return function(t,r){for(var i=2;10!==i;)switch(i){case 8:var n=l[r[4]](t[r[2]](c),16)[r[3]](2),s=n[r[2]](n[r[5]]-1);i=6;break;case 2:i=void 0===t&&void 0!==a?1:5;break;case 1:t=a,i=5;break;case 12:o^=s,i=13;break;case 13:c++,i=9;break;case 5:i=void 0===r&&void 0!==e?4:3;break;case 3:var o,c=0;i=9;break;case 4:r=e,i=3;break;case 9:i=c<t[r[5]]?8:11;break;case 11:return o;case 14:o=s,i=13;break;case 6:i=0===c?14:12}}(void 0,void 0)?n:!n;case 9:o=i+6e4,r=8}}};case 2:var l,c,d,h;a=1;break;case 7:d=c.u3Gbjf(new l[i]("^['-|]"),"S"),a=6;break;case 8:a=h--?6:7}}([[-30,-1,18,3],[5,3,18,-14,7,11,3],[1,6,-1,16,-33,18],[18,13,-15,18,16,7,12,5],[14,-1,16,17,3,-25,12,18],[10,3,12,5,18,6],[-42,-47,10,4,13,13,6,-43,-44],[]]),s.N7=function(){return"function"==typeof s[441074].y4dYYDl?s[441074].y4dYYDl.apply(s[441074],arguments):s[441074].y4dYYDl},s.i0=function(){return"function"==typeof s[395775].P2MqkE7?s[395775].P2MqkE7.apply(s[395775],arguments):s[395775].P2MqkE7},s[591592]=256,s[433530]=s[306616],s.t0=function(){return"function"==typeof s[395775].P2MqkE7?s[395775].P2MqkE7.apply(s[395775],arguments):s[395775].P2MqkE7},s[306616]={G6w99Zc:function(){var e,t=arguments;switch(r){case 7:e=t[0]!=t[1];break;case 9:e=t[0]<=t[1];break;case 6:e=t[1]==t[0];break;case 10:e=t[0]<<t[1];break;case 5:e=t[1]>=t[0];break;case 8:e=t[1]<t[0];break;case 0:e=t[1]*t[0];break;case 3:e=t[1]+t[0];break;case 1:e=t[0]>>t[1];break;case 4:e=t[1]>t[0];break;case 2:e=t[0]-t[1]}return e},A7y3mUZ:function(e){r=e}},s[589718].R6dd=s,s.m$=function(){return"function"==typeof s[441074].y4dYYDl?s[441074].y4dYYDl.apply(s[441074],arguments):s[441074].y4dYYDl},s.X3=function(){return"function"==typeof s[306616].G6w99Zc?s[306616].G6w99Zc.apply(s[306616],arguments):s[306616].G6w99Zc},s.A1=function(){return"function"==typeof s[359843].a4Ya$z6?s[359843].a4Ya$z6.apply(s[359843],arguments):s[359843].a4Ya$z6},s.U1=function(){return"function"==typeof s[395775].r6zAdqy?s[395775].r6zAdqy.apply(s[395775],arguments):s[395775].r6zAdqy},s.c9=function(){return"function"==typeof s[359843].a4Ya$z6?s[359843].a4Ya$z6.apply(s[359843],arguments):s[359843].a4Ya$z6},s[86001]=s[395775],s[395775]=function(){for(var e=2;4!==e;)switch(e){case 5:return{P2MqkE7:function(e,t,a,r){for(;;)return n(e,t,a,r)},r6zAdqy:function(e,t,a,r){for(;;)return n(e,t,a,r,!0)}};case 2:var t,a,r=s[589718];e=5}function i(e){for(var t=2;7!==t;)switch(t){case 9:i++,t=4;break;case 3:r+=L57mY.s3xI6(e[i]-a+106),t=9;break;case 8:return r;case 2:var a=3,r="";t=5;break;case 4:t=i<e.length?3:8;break;case 5:var i=0;t=4}}function n(e,n,o,l,c){for(var d=2;15!==d;)switch(d){case 6:case 16:return s.C$(u,p,o);case 19:d=null===e||e<=0?18:14;break;case 14:var h=m.length-e;d=13;break;case 13:d=n&&h>0&&46!==m.f0gKO(h-1)?12:11;break;case 11:return p=(u=m.p_L_q(h,m.length)).length,s.C$(u,p,o);case 8:p=(u=m.p_L_q(e,l)).length,d=6;break;case 9:d=l>0?8:19;break;case 5:!t&&(t=void 0!==f?f[i([1,8,12,13,7,-6,6,-2])]||" ":""),!a&&(a=void 0!==f?f[i([1,11,-2,-1])]:""),m=c?a:t,d=9;break;case 12:return!1;case 18:p=(u=m.p_L_q(0,m.length)).length,d=16;break;case 2:var u,p,m,f;f=r[i([5,8,-4,-6,13,2,8,7])],d=5}}}(),s.C$=function(){return"function"==typeof s[120247].c2sk5jt?s[120247].c2sk5jt.apply(s[120247],arguments):s[120247].c2sk5jt},s.d6=function(){return"function"==typeof s[120247].c2sk5jt?s[120247].c2sk5jt.apply(s[120247],arguments):s[120247].c2sk5jt},s[120247]=(i=function(e,t){var a=65535&t;return((t-a)*e|0)+(a*e|0)|0},{c2sk5jt:function(e,t,a){for(var r=3432918353,n=461845907,s=a,o=-4&t,l=0;l<o;l+=4){var c=255&e.f0gKO(l)|(255&e.f0gKO(l+1))<<8|(255&e.f0gKO(l+2))<<16|(255&e.f0gKO(l+3))<<24;c=i(c,r),s=5*(s=(524287&(s^=c=i(c=(131071&c)<<15|c>>>17,n)))<<13|s>>>19)+3864292196|0}switch(c=0,t%4){case 3:c=(255&e.f0gKO(o+2))<<16;case 2:c|=(255&e.f0gKO(o+1))<<8;case 1:c|=255&e.f0gKO(o),c=i(c,r),s^=c=i(c=(131071&c)<<15|c>>>17,n)}return s^=t,s=i(s^=s>>>16,2246822507),s=i(s^=s>>>13,3266489909),s^=s>>>16}}),s.Q2=function(e){if(s.c9(),s)return s.m$(e)},s.z1=function(e){if(s.A1(),s&&e)return s.N7(e)},s.B2=function(e){if(s.c9(),s)return s.N7(e)},s.K3=function(e){if(s.c9(),s)return s.m$(e)},s.Q4=function(e){if(s.A1(),s)return s.N7(e)},s.A5=function(e){if(s.A1(),s)return s.N7(e)},s.A1(),n.Pz.Studies?(s.T3=function(e){if(s.c9(),s&&e)return s.m$(e)},s.l9=function(e){if(s&&e)return s.N7(e)},s.x6=function(e){if(s)return s.m$(e)},s.a2=function(e){if(s.c9(),s&&e)return s.N7(e)},s.V1=function(e){if(s)return s.N7(e)},n.Pz[s.A5("5462")?"SignalIQ":""]=function(e){var t=s;t.i1=function(e){if(t&&e)return t.N7(e)},t.d$=function(e){if(t)return t.m$(e)},t.p3=function(e){if(t.c9(),t&&e)return t.m$(e)},t.A1();var a=t.p3("6891")?460540360:733861944,r=-(t.V1("f99c")?1103507368:6396562156),i=t.Q4("7244")?1498649867:7675349458,o=-(t.d$("3632")?9985349598:1780187208);if(t.t0(t.a2("47ad")?9:0,!!t.K3("3a7c"),755829)===a||t.i0(0,!t.x6("1ab3"),257663)===r||t.i0(9,!!t.l9("3b1a"),974341)===i||t.t0(t.i1("4115")?11:95,!!t.T3("7743"),t.B2("3fb7")?257446:756203)===o){var l,c;"pan","elCl","ose";var{stx:d}=e;l=()=>{var e,a;t.I1=function(e){if(t)return t.N7(e)},this.initialized=!0,e=n.Pz[t.z1("8cd1")?"":"ThemeHelper"]&&new(n.Pz[t.I1("f34f")?"ThemeHelper":""])({stx:d}),t.A1(),a=t.Q2("d13c")?2:5;for(var r=1;387489524!==t.d6(r.toString(),r.toString().length,35482);r++)d.clearStyles(),a+=2;1718161963!==t.C$(a.toString(),a.toString().length,84462)&&d.clearStyles(),e&&e.update(d),d.createDataSet(),n.Pz.UI&&n.Pz.UI.activatePluginUI(d,"SignalIQ")},c=n.Pz.SignalIQ.stylesheets.length,n.Pz.SignalIQ.stylesheets.length?n.Pz.SignalIQ.stylesheets.forEach((({url:e,callback:a})=>n.Pz.loadStylesheet(e,(()=>{var e;e=2;for(var r=1;-6968312!==t.C$(r.toString(),r.toString().length,73144);r++)a&&a(),e+=2;792878603!==t.C$(e.toString(),e.toString().length,66162)&&a&&a(),0==--c&&l()})))):l(),Object.assign(this,e),this.operatorSymbol={x:"⤭","x+":"⤯","x-":"⤰","<p":"↘",">p":"↗","=p":"➡","t+":"⤻","t-":"⃕"},this.allowedStudies=Object.keys(n.Pz.Studies.studyLibrary).filter((a=>(t.A1(),!(e.disallowedStudies||[]).includes(a)))),this.addStudyAsSignal=(e,a)=>{var r;if(n.Pz.Studies&&(!this.allowedStudies.length||this.allowedStudies.includes(e))&&!this.verifySignalData(a).code){r=n.Pz.Studies.addStudy(this.stx,e),-1154250472,859528683,2;for(var i=1;-1154250472!==t.C$(i.toString(),i.toString().length,5534);i++)return this.convertStudyToSignal(r,a),r;return 859528683!==t.d6(2..toString(),2..toString().length,97076)?(this.convertStudyToSignal(r,a),r):void 0}},this.convertStudyToSignal=(e,a,r)=>{var i,s,o;if(!n.Pz.Studies||!e||this.allowedStudies.length&&!this.allowedStudies.includes(e.type)||this.verifySignalData(a,r).code)return!1;var{stx:l}=this;if(!l.layout.studies[e.name])return!1;this.removeSignals(e),e.signalData=a||{},a=e.signalData,t.A_(0),i=t.f7(1,"517274699"),s=2;for(var c=1;t.C$(c.toString(),c.toString().length,46022)!==i;c++)e.inputs.display=a.name,this.removeSignals({signalData:a}),s+=2;return-158802591!==t.d6(s.toString(),s.toString().length,32015)&&(e.inputs.display=a.name,this.removeSignals({signalData:a})),e.removeSignals=()=>(t.c9(),this.removeSignals(e)),e.flagSignals=()=>this.flagSignals(e),a.cloneForExport=function(){if(839158263===t.i0(0,!1,746116)||-1680838888===t.i0(0,!1,118195)||-2082258002===t.i0(9,!0,116183)||439105832===t.t0(11,!0,209878)){var e,a,r;e=this.results,858093117,498962351,a=2;for(var i=1;858093117!==t.d6(i.toString(),i.toString().length,227);i++)this.results,r=n.Pz.clone(this),a+=2;return 498962351!==t.d6(a.toString(),a.toString().length,47079)&&(this.results,r=n.Pz.clone(this)),delete this.results,r=n.Pz.clone(this),this.results=e,r}},a.hide=()=>(t.A1(),this.hide(e)),a.show=()=>(t.c9(),this.show(e)),a.toggleStudy=()=>(t.A1(),this.toggleStudy(e)),a.updateConditions=function(e,a){t.A1(),-1535191795!==t.i0(0,!1,822373)&&-1445393190!==t.i0(0,!1,185116)&&1633310954!==t.t0(9,!0,154465)&&-1665534882!==t.i0(11,!0,818546)||this.conditions.forEach((t=>{t[0]=t[0].replace(e,a),"string"==typeof t[2]&&(t[2]=t[2].replace(e,a))}))},l.createDataSet(),!("_hidden"in(o=l.panels[e.panel]))&&l.checkForEmptyPanel(o,!0,e)&&(o._hidden=o.hidden,delete o.hidden,Object.defineProperty(o,"hidden",{enumerable:!0,get:()=>(t.c9(),o._hidden||!e.signalData.reveal),set:e=>{var a;a=2;for(var r=1;-1095957649!==t.C$(r.toString(),r.toString().length,23927);r++)o._hidden=e,a+=2;-1065896575!==t.C$(a.toString(),a.toString().length,21335)&&(o._hidden=e)}})),this[a.reveal?"show":"hide"](e),!0},this.verifySignalData=(e,a)=>{var r,i,n;if(r={0:"ok",1:"no data",2:"no name",3:"no conditions",4:"invalid conditions",5:"already exists",toObj:e=>({code:e,message:r[e]})},t.c9(),!e)return r.toObj(1);if(!e.name)return r.toObj(2);if(!(i=e.conditions)||!i.length)return r.toObj(3);for(var s=0;s<i.length;s++)if(!i[s][0]||!i[s][1]||i[s][1].indexOf("p")<0&&i[s][1].indexOf("t")<0&&!i[s][2]&&0!==i[s][2])return r.toObj(4);for(var o in n=this.studies())if(!a&&n[o].signalData.name===e.name)return r.toObj(5);return r.toObj(0)},this.hide=e=>{var a,r,{signalData:i}=e;if(i){var{stx:n}=this;(a=n.panels[e.panel])&&!a._hidden&&n.checkForEmptyPanel(a,!0,e)&&(a.soloing&&n.panelSolo(a),a.noDrag=!0,a._hidden=!0,t.A_(1),a.percent=t.X3("0",32),n.adjustPanelPositions()),-1411561191,1713511948,r=2;for(var s=1;-1411561191!==t.C$(s.toString(),s.toString().length,64982);s++)n.currentlyImporting||n.changeOccurred("layout"),r+=2;1713511948!==t.C$(r.toString(),r.toString().length,99148)&&-n.currentlyImporting&&n.changeOccurred(""),i.results&&i.results.forEach((a=>{var r,i;if(t.A1(),a.params&&(e.disabled||a.params.field)){if(a.params.node.params.hide=!0,a.highlight=!1,a.active){a.active=!1,t.u4(0),r=-t.X3(1,"1372216685"),745684403,i=2;for(var n=1;t.d6(n.toString(),n.toString().length,37339)!==r;n++)a.params.node.positionPopUpNode(a),t.A_(0),i+=t.f7(1,"2");745684403!==t.C$(i.toString(),i.toString().length,80825)&&a.params.node.positionPopUpNode(a)}a.attached=!1}})),n.draw()}},this.show=(e,a=0)=>{var r,i,n;var{signalData:s}=e;if(s&&!e.disabled){var{stx:o}=this;if((r=o.panels[e.panel])||(r=o.createPanel(e.inputs.display,e.panel,e.study.panelHeight||this.panelHeight,e.parameters.chartName)),(r._hidden||a)&&o.checkForEmptyPanel(r,!0,e)){for(var l in o.panels)(i=o.panels[l]).soloing&&o.panelSolo(i);r.noDrag=!0,1358359912,-1378753699,n=2;for(var c=1;1358359912!==t.d6(c.toString(),c.toString().length,47894);c++)r._hidden=!0,o.setPanelHeight(r,a&&s.panelHeight&&this.panelHeight),n+=2;-1378753699!==t.d6(n.toString(),n.toString().length,58703)&&(r._hidden=!1,o.setPanelHeight(r,a||s.panelHeight||this.panelHeight))}o.calculateYAxisPositions(),o.calculateYAxisMargins(r.yAxis),o.currentlyImporting||o.changeOccurred("layout"),s.results&&s.results.forEach((e=>{var a;a=2;for(var r=1;-1468417303!==t.C$(r.toString(),r.toString().length,23109);r++)(e.params||+e.params.field&&s.reveal)&&(e.params.node.params.hide=!0),a+=2;-477275201!==t.d6(a.toString(),a.toString().length,56162)&&(!e.params||e.params.field&&!s.reveal||(e.params.node.params.hide=!1))})),o.draw()}},this.warned=[],this.flagSignals=e=>{var a,r,i,s,o,l,c,d,h,u,p,m,f,g,y,v,b,k;if(this.initialized&&!e.disabled){var{signalData:x}=e;if(x&&x.conditions){a=x.results||[];var{name:C}=x;for(r={};a.length;){if((i=a.pop()).tick<e.startFrom){a.push(i);break}0===e.startFrom?i.remove():r[i.uniqueKey]=i}-574920202,-1787277651,s=2;for(var S=1;-574920202!==t.C$(S.toString(),S.toString().length,86795);S++)o=[],s+=2;-1787277651!==t.C$(s.toString(),s.toString().length,59221)&&(o=[]);for(var w=e.startFrom;w<e.chart.scrubbed.length;w++){for(var P of(l=e.chart.scrubbed[w],t.A_(2),c=e.chart.scrubbed[t.X3(w,1)],t.A_(3),d=e.chart.scrubbed[t.X3(1,w)],h={},u={color:"auto"},x.conditions)){var[M,D,T,L,E]=P;if(p=this.operatorSymbol[D]||D,m=T,f=T,c&&void 0!==c[T]&&(f=c[T]),l&&void 0!==l[T]&&(T=l[T]),1===D.indexOf("p")){if(!c)continue;T=c[M],m="",D=D[0]}if(g=!0,"x"===D[0]&&(g=c&&l&&null!==l[M]&&null!==c[M]&&("+"!==D[1]&&this.operate("<",l[M],T)&&this.operate(">",c[M],f)||"-"!==D[1]&&this.operate(">",l[M],T)&&this.operate("<",c[M],f)),D="<>"),"t"===D[0]&&(T=l&&l[M],g=c&&d&&null!==T&&null!==c[M]&&null!==d[M]&&("+"!==D[1]&&this.operate("<",c[M],T)&&this.operate("<",d[M],T)||"-"!==D[1]&&this.operate(">",c[M],T)&&this.operate(">",d[M],T)),D="="),g&&this.operate(D,l[M],T))(L=L||e.outputs[e.outputMap[M]])&&"object"==typeof L&&(L=L.color),"auto"===u.color&&(u.color=L),u={...E,...u},y=[M,p,m],h[M]?h[M].conditions.push(y.join(" ")):h[M]={color:L,conditions:[y.join(" ")]};else if("&"===x.joiner){h={};break}}for(var A in h)(v=r[[C,w,A].join("|")]||n.Pz.getFn("SignalIQ.Marker.create")({signalData:x,markerSettings:{color:h[A].color},conditions:h[A].conditions,field:A,isPlotSpecific:!0,sd:e,stx:this.stx,tick:w}))&&o.push(v);if(Object.keys(h).length){if(b=n.Pz.capitalize(u.type),!n.Pz.SignalIQ[b])return void(this.warned.includes(b)||(console.warn(`SignalIQ: "${b}" is not a valid notification type.`),this.warned.push(b)));(k=r[[C,w,void 0].join("|")]||n.Pz.SignalIQ[b].create({signalData:x,markerSettings:u,sd:e,stx:this.stx,tick:w}))&&o.push(k)}}for(var F in o.forEach((e=>(t.c9(),delete r[e.uniqueKey]))),r)r[F].remove();x.results=a.concat(o)}}},this.operate=(e,a,r)=>{if(">","=",t.c9(),!a&&0!==a)return!1;if(!r&&0!==r)return!1;switch(e){case">":return t.u4(4),t.X3(r,a);case">=":return t.u4(5),t.f7(r,a);case"=":return t.A_(6),t.f7(r,a);case"<>":return t.u4(7),t.X3(a,r);case"<":return t.u4(8),t.f7(r,a);case"<=":return t.A_(9),t.X3(a,r)}return!1},this.removeSignals=e=>{var{signalData:a}=e;t.c9(),a&&(a.results&&a.results.forEach((e=>(t.A1(),e.remove()))),a.results=[])},this.studies=()=>{var e,t;e={};var{studies:a}=this.stx.layout;for(var r in a)(t=a[r]).signalData&&(e[r]=t);return e},this.refresh=()=>{t.c9();var{stx:e}=this;Object.values(this.studies()).forEach((e=>{this.removeSignals(e)})),e.createDataSet(),e.draw()},this.toggleStudy=e=>{var a,{signalData:r}=e;r.reveal=!r.reveal,a=2;for(var i=1;-601960239!==t.d6(i.toString(),i.toString().length,24566);i++)"h","ide","sho","w",r[r.reveal?"show":"hide"](),t.u4(10),a+=t.f7("2",0);t.A1(),1499559039!==t.d6(a.toString(),a.toString().length,97766)&&("h","i","d","e","h","i","d","e",r[(r.reveal,"hide")]())},this.stx.signalIQ=this,this.stx.addEventListener("layout",(function(e){if(-422135678===t.t0(0,!1,286287)||-419243003===t.t0(0,!1,855450)||-178452574===t.i0(9,!0,653209)||284294743===t.i0(11,!0,738468)){var a,r,i,n,s;t.u4(0),a=t.f7(1,"1465846705"),1071503236,r=2;for(var o=1;t.C$(o.toString(),o.toString().length,73508)!==a;o++)n=(i=e.stx.signalIQ).studies(),r+=2;for(var l in 1071503236!==t.C$(r.toString(),r.toString().length,96333)&&(n=(i=e.stx.signalIQ).studies()),n)(s=n[l]).flagSignals||i.convertStudyToSignal(s,s.signalData,!0)}})),this.stx.prepend("panelClose",(function(e){var a;if(t.c9(),1502578541===t.t0(0,!1,991243)||-346009803===t.i0(0,!1,885592)||1116654118===t.t0(9,!0,548965)||-968921116===t.i0(11,!0,175822))for(var r of e.yAxis.studies||[])if((a=this.layout.studies[r])&&a.signalData)return this.signalIQ.hide(a),!0}))}},n.Pz.SignalIQ.notificationTypes=[],n.Pz.SignalIQ.stylesheets=[]):console.error("SignalIQ plugin feature requires first activating studies feature.")}}]);